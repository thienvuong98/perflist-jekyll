<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>NoMethodError at /playlist/list/2024-03-TH</title>

  <script type="text/javascript">
  //<!--
  function toggle(id) {
    var pre  = document.getElementById("pre-" + id);
    var post = document.getElementById("post-" + id);
    var context = document.getElementById("context-" + id);

    if (pre.style.display == 'block') {
      pre.style.display = 'none';
      post.style.display = 'none';
      context.style.background = "none";
    } else {
      pre.style.display = 'block';
      post.style.display = 'block';
      context.style.background = "#fffed9";
    }
  }

  function toggleBacktrace(){
    var bt = document.getElementById("backtrace");
    var toggler = document.getElementById("expando");

    if (bt.className == 'condensed') {
      bt.className = 'expanded';
      toggler.innerHTML = "(condense)";
    } else {
      bt.className = 'condensed';
      toggler.innerHTML = "(expand)";
    }
  }
  //-->
  </script>

<style type="text/css" media="screen">
  *                   {margin: 0; padding: 0; border: 0; outline: 0;}
  div.clear           {clear: both;}
  body                {background: #EEEEEE; margin: 0; padding: 0;
                       font-family: 'Lucida Grande', 'Lucida Sans Unicode',
                       'Garuda';}
  code                {font-family: 'Lucida Console', monospace;
                       font-size: 12px;}
  li                  {height: 18px;}
  ul                  {list-style: none; margin: 0; padding: 0;}
  ol:hover            {cursor: pointer;}
  ol li               {white-space: pre;}
  #explanation        {font-size: 12px; color: #666666;
                       margin: 20px 0 0 100px;}
/* WRAP */
  #wrap               {width: 1000px; background: #FFFFFF; margin: 0 auto;
                       padding: 30px 50px 20px 50px;
                       border-left: 1px solid #DDDDDD;
                       border-right: 1px solid #DDDDDD;}
/* HEADER */
  #header             {margin: 0 auto 25px auto;}
  #header img         {float: left;}
  #header #summary    {float: left; margin: 12px 0 0 20px; width:660px;
                       font-family: 'Lucida Grande', 'Lucida Sans Unicode';}
  h1                  {margin: 0; font-size: 36px; color: #981919;}
  h2                  {margin: 0; font-size: 22px; color: #333333;}
  #header ul          {margin: 0; font-size: 12px; color: #666666;}
  #header ul li strong{color: #444444;}
  #header ul li       {display: inline; padding: 0 10px;}
  #header ul li.first {padding-left: 0;}
  #header ul li.last  {border: 0; padding-right: 0;}
/* BODY */
  #backtrace,
  #get,
  #post,
  #cookies,
  #rack               {width: 980px; margin: 0 auto 10px auto;}
  p#nav               {float: right; font-size: 14px;}
/* BACKTRACE */
  a#expando           {float: left; padding-left: 5px; color: #666666;
                      font-size: 14px; text-decoration: none; cursor: pointer;}
  a#expando:hover     {text-decoration: underline;}
  h3                  {float: left; width: 100px; margin-bottom: 10px;
                       color: #981919; font-size: 14px; font-weight: bold;}
  #nav a              {color: #666666; text-decoration: none; padding: 0 5px;}
  #backtrace li.frame-info {background: #f7f7f7; padding-left: 10px;
                           font-size: 12px; color: #333333;}
  #backtrace ul       {list-style-position: outside; border: 1px solid #E9E9E9;
                       border-bottom: 0;}
  #backtrace ol       {width: 920px; margin-left: 50px;
                       font: 10px 'Lucida Console', monospace; color: #666666;}
  #backtrace ol li    {border: 0; border-left: 1px solid #E9E9E9;
                       padding: 2px 0;}
  #backtrace ol code  {font-size: 10px; color: #555555; padding-left: 5px;}
  #backtrace-ul li    {border-bottom: 1px solid #E9E9E9; height: auto;
                       padding: 3px 0;}
  #backtrace-ul .code {padding: 6px 0 4px 0;}
  #backtrace.condensed .system,
  #backtrace.condensed .framework {display:none;}
/* REQUEST DATA */
  p.no-data           {padding-top: 2px; font-size: 12px; color: #666666;}
  table.req           {width: 980px; text-align: left; font-size: 12px;
                       color: #666666; padding: 0; border-spacing: 0;
                       border: 1px solid #EEEEEE; border-bottom: 0;
                       border-left: 0;
                       clear:both}
  table.req tr th     {padding: 2px 10px; font-weight: bold;
                       background: #F7F7F7; border-bottom: 1px solid #EEEEEE;
                       border-left: 1px solid #EEEEEE;}
  table.req tr td     {padding: 2px 20px 2px 10px;
                       border-bottom: 1px solid #EEEEEE;
                       border-left: 1px solid #EEEEEE;}
/* HIDE PRE/POST CODE AT START */
  .pre-context,
  .post-context       {display: none;}

  table td.code       {width:750px}
  table td.code div   {width:750px;overflow:hidden}
</style>
</head>
<body>
  <div id="wrap">
    <div id="header">
      <img src="/playlist/__sinatra__/500.png" alt="application error" height="161" width="313" />
      <div id="summary">
        <h1><strong>NoMethodError</strong> at <strong>/playlist/list/2024-03-TH
          </strong></h1>
        <h2>undefined method `empty?&#39; for nil:NilClass</h2>
        <ul>
          <li class="first"><strong>file:</strong> <code>
            program.slim</code></li>
          <li><strong>location:</strong> <code>block in __tilt_685680
            </code></li>
          <li class="last"><strong>line:
            </strong> 118</li>
        </ul>
      </div>
      <div class="clear"></div>
    </div>

    <div id="backtrace" class='condensed'>
      <h3>BACKTRACE</h3>
      <p><a href="#" id="expando"
            onclick="toggleBacktrace(); return false">(expand)</a></p>
      <p id="nav"><strong>JUMP TO:</strong>
         
            <a href="#get-info">GET</a>
            <a href="#post-info">POST</a>
         
         <a href="#cookie-info">COOKIES</a>
         <a href="#env-info">ENV</a>
      </p>
      <div class="clear"></div>

      <ul id="backtrace-ul">

      
      
          

            <li class="frame-info app">
              <code>/app/controllers/../views/program.slim</code> in
                <code><strong>block in __tilt_685680</strong></code>
            </li>

            <li class="code app">
              
              <ol start="111"
                  class="pre-context" id="pre-1"
                  onclick="toggle(1);">
                
                <li class="pre-context-line"><code>          tr id=row_id
</code></li>
                
                <li class="pre-context-line"><code>            - perf_url = e[:perf_url] || &#39;&#39;
</code></li>
                
                <li class="pre-context-line"><code>            - yt_video = nil
</code></li>
                
                <li class="pre-context-line"><code>            - tempo = e[:perf_tempo] || e[:tempo]
</code></li>
                
                <li class="pre-context-line"><code>            td= index+2
</code></li>
                
                <li class="pre-context-line"><code>            td
</code></li>
                
                <li class="pre-context-line"><code>              .d-grid.gap-2
</code></li>
                
              </ol>
              

              <ol start="118" class="context" id="1"
                  onclick="toggle(1);">
                <li class="context-line" id="context-1"><code>                - if !e[:lyric].empty?</code></li>
              </ol>

              
              <ol start="119" class="post-context"
                  id="post-1" onclick="toggle(1);">
                
                <li class="post-context-line"><code>                  - color = tempo_color(tempo)
</code></li>
                
                <li class="post-context-line"><code>                  a.btn.btn-sm.btn-outline-secondary.chorder.mtooltip style=&quot;background-color:#{color}&quot; onClick=&quot;get_lyric(&#39;#{program}&#39;, &#39;#{row_id}&#39;, #{async})&quot; title=&quot;Lyric for: #{e[:title]}, tempo: #{tempo}&quot;
</code></li>
                
                <li class="post-context-line"><code>                    b= (e[:key] &amp;&amp; !e[:key].empty?) ? e[:key] : &#39;?&#39;
</code></li>
                
                <li class="post-context-line"><code>                    - if e[:transpose]
</code></li>
                
                <li class="post-context-line"><code>                      span.transpose title=&quot;Transpose&quot; = e[:transpose]
</code></li>
                
                <li class="post-context-line"><code>                    span.= e[:lead] ? &quot; (#{e[:lead]})&quot; : &quot;&quot;
</code></li>
                
                <li class="post-context-line"><code>                - else
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info app">
              <code>/app/controllers/../views/program.slim</code> in
                <code><strong>each</strong></code>
            </li>

            <li class="code app">
              
              <ol start="102"
                  class="pre-context" id="pre-2"
                  onclick="toggle(2);">
                
                <li class="pre-context-line"><code>          th= ltype == &quot;list&quot; ? &quot;Singer [Backing]&quot; : &quot;List&quot;
</code></li>
                
                <li class="pre-context-line"><code>          th Beat [Tempo]
</code></li>
                
                <li class="pre-context-line"><code>          th Perf Video/Loops
</code></li>
                
                <li class="pre-context-line"><code>          th Note
</code></li>
                
                <li class="pre-context-line"><code>          th.hiddenCol S-Title
</code></li>
                
                <li class="pre-context-line"><code>      tbody
</code></li>
                
                <li class="pre-context-line"><code>        - async = params[:static] ? &#39;false&#39; : &#39;true&#39;
</code></li>
                
              </ol>
              

              <ol start="109" class="context" id="2"
                  onclick="toggle(2);">
                <li class="context-line" id="context-2"><code>        - content[:__list].each_with_index do |e, index|</code></li>
              </ol>

              
              <ol start="110" class="post-context"
                  id="post-2" onclick="toggle(2);">
                
                <li class="post-context-line"><code>          - row_id = &quot;row_#{index}&quot;
</code></li>
                
                <li class="post-context-line"><code>          tr id=row_id
</code></li>
                
                <li class="post-context-line"><code>            - perf_url = e[:perf_url] || &#39;&#39;
</code></li>
                
                <li class="post-context-line"><code>            - yt_video = nil
</code></li>
                
                <li class="post-context-line"><code>            - tempo = e[:perf_tempo] || e[:tempo]
</code></li>
                
                <li class="post-context-line"><code>            td= index+2
</code></li>
                
                <li class="post-context-line"><code>            td
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info app">
              <code>/app/controllers/../views/program.slim</code> in
                <code><strong>each_with_index</strong></code>
            </li>

            <li class="code app">
              
              <ol start="102"
                  class="pre-context" id="pre-3"
                  onclick="toggle(3);">
                
                <li class="pre-context-line"><code>          th= ltype == &quot;list&quot; ? &quot;Singer [Backing]&quot; : &quot;List&quot;
</code></li>
                
                <li class="pre-context-line"><code>          th Beat [Tempo]
</code></li>
                
                <li class="pre-context-line"><code>          th Perf Video/Loops
</code></li>
                
                <li class="pre-context-line"><code>          th Note
</code></li>
                
                <li class="pre-context-line"><code>          th.hiddenCol S-Title
</code></li>
                
                <li class="pre-context-line"><code>      tbody
</code></li>
                
                <li class="pre-context-line"><code>        - async = params[:static] ? &#39;false&#39; : &#39;true&#39;
</code></li>
                
              </ol>
              

              <ol start="109" class="context" id="3"
                  onclick="toggle(3);">
                <li class="context-line" id="context-3"><code>        - content[:__list].each_with_index do |e, index|</code></li>
              </ol>

              
              <ol start="110" class="post-context"
                  id="post-3" onclick="toggle(3);">
                
                <li class="post-context-line"><code>          - row_id = &quot;row_#{index}&quot;
</code></li>
                
                <li class="post-context-line"><code>          tr id=row_id
</code></li>
                
                <li class="post-context-line"><code>            - perf_url = e[:perf_url] || &#39;&#39;
</code></li>
                
                <li class="post-context-line"><code>            - yt_video = nil
</code></li>
                
                <li class="post-context-line"><code>            - tempo = e[:perf_tempo] || e[:tempo]
</code></li>
                
                <li class="post-context-line"><code>            td= index+2
</code></li>
                
                <li class="post-context-line"><code>            td
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info app">
              <code>/app/controllers/../views/program.slim</code> in
                <code><strong>__tilt_685680</strong></code>
            </li>

            <li class="code app">
              
              <ol start="102"
                  class="pre-context" id="pre-4"
                  onclick="toggle(4);">
                
                <li class="pre-context-line"><code>          th= ltype == &quot;list&quot; ? &quot;Singer [Backing]&quot; : &quot;List&quot;
</code></li>
                
                <li class="pre-context-line"><code>          th Beat [Tempo]
</code></li>
                
                <li class="pre-context-line"><code>          th Perf Video/Loops
</code></li>
                
                <li class="pre-context-line"><code>          th Note
</code></li>
                
                <li class="pre-context-line"><code>          th.hiddenCol S-Title
</code></li>
                
                <li class="pre-context-line"><code>      tbody
</code></li>
                
                <li class="pre-context-line"><code>        - async = params[:static] ? &#39;false&#39; : &#39;true&#39;
</code></li>
                
              </ol>
              

              <ol start="109" class="context" id="4"
                  onclick="toggle(4);">
                <li class="context-line" id="context-4"><code>        - content[:__list].each_with_index do |e, index|</code></li>
              </ol>

              
              <ol start="110" class="post-context"
                  id="post-4" onclick="toggle(4);">
                
                <li class="post-context-line"><code>          - row_id = &quot;row_#{index}&quot;
</code></li>
                
                <li class="post-context-line"><code>          tr id=row_id
</code></li>
                
                <li class="post-context-line"><code>            - perf_url = e[:perf_url] || &#39;&#39;
</code></li>
                
                <li class="post-context-line"><code>            - yt_video = nil
</code></li>
                
                <li class="post-context-line"><code>            - tempo = e[:perf_tempo] || e[:tempo]
</code></li>
                
                <li class="post-context-line"><code>            td= index+2
</code></li>
                
                <li class="post-context-line"><code>            td
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/tilt-2.4.0/lib/tilt/template.rb</code> in
                <code><strong>bind_call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="200"
                  class="pre-context" id="pre-5"
                  onclick="toggle(5);">
                
                <li class="pre-context-line"><code>        # :nocov:
</code></li>
                
                <li class="pre-context-line"><code>        scope_class = USE_BIND_CALL ? CLASS_METHOD.bind_call(scope) : CLASS_METHOD.bind(scope).call
</code></li>
                
                <li class="pre-context-line"><code>        # :nocov:
</code></li>
                
                <li class="pre-context-line"><code>      end
</code></li>
                
                <li class="pre-context-line"><code>      method = compiled_method(locals_keys, scope_class)
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      if USE_BIND_CALL
</code></li>
                
              </ol>
              

              <ol start="207" class="context" id="5"
                  onclick="toggle(5);">
                <li class="context-line" id="context-5"><code>        method.bind_call(scope, locals, &amp;block)</code></li>
              </ol>

              
              <ol start="208" class="post-context"
                  id="post-5" onclick="toggle(5);">
                
                <li class="post-context-line"><code>      # :nocov:
</code></li>
                
                <li class="post-context-line"><code>      else
</code></li>
                
                <li class="post-context-line"><code>        method.bind(scope).call(locals, &amp;block)
</code></li>
                
                <li class="post-context-line"><code>      # :nocov:
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/tilt-2.4.0/lib/tilt/template.rb</code> in
                <code><strong>evaluate</strong></code>
            </li>

            <li class="code system">
              
              <ol start="200"
                  class="pre-context" id="pre-6"
                  onclick="toggle(6);">
                
                <li class="pre-context-line"><code>        # :nocov:
</code></li>
                
                <li class="pre-context-line"><code>        scope_class = USE_BIND_CALL ? CLASS_METHOD.bind_call(scope) : CLASS_METHOD.bind(scope).call
</code></li>
                
                <li class="pre-context-line"><code>        # :nocov:
</code></li>
                
                <li class="pre-context-line"><code>      end
</code></li>
                
                <li class="pre-context-line"><code>      method = compiled_method(locals_keys, scope_class)
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      if USE_BIND_CALL
</code></li>
                
              </ol>
              

              <ol start="207" class="context" id="6"
                  onclick="toggle(6);">
                <li class="context-line" id="context-6"><code>        method.bind_call(scope, locals, &amp;block)</code></li>
              </ol>

              
              <ol start="208" class="post-context"
                  id="post-6" onclick="toggle(6);">
                
                <li class="post-context-line"><code>      # :nocov:
</code></li>
                
                <li class="post-context-line"><code>      else
</code></li>
                
                <li class="post-context-line"><code>        method.bind(scope).call(locals, &amp;block)
</code></li>
                
                <li class="post-context-line"><code>      # :nocov:
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/tilt-2.4.0/lib/tilt/template.rb</code> in
                <code><strong>render</strong></code>
            </li>

            <li class="code system">
              
              <ol start="95"
                  class="pre-context" id="pre-7"
                  onclick="toggle(7);">
                
                <li class="pre-context-line"><code>      prepare
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    # Render the template in the given scope with the locals specified. If a
</code></li>
                
                <li class="pre-context-line"><code>    # block is given, it is typically available within the template via
</code></li>
                
                <li class="pre-context-line"><code>    # +yield+.
</code></li>
                
                <li class="pre-context-line"><code>    def render(scope=nil, locals=nil, &amp;block)
</code></li>
                
              </ol>
              

              <ol start="102" class="context" id="7"
                  onclick="toggle(7);">
                <li class="context-line" id="context-7"><code>      evaluate(scope || Object.new, locals || EMPTY_HASH, &amp;block)</code></li>
              </ol>

              
              <ol start="103" class="post-context"
                  id="post-7" onclick="toggle(7);">
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>    # The basename of the template file.
</code></li>
                
                <li class="post-context-line"><code>    def basename(suffix=&#39;&#39;)
</code></li>
                
                <li class="post-context-line"><code>      File.basename(@file, suffix) if @file
</code></li>
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>render</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="864"
                  class="pre-context" id="pre-8"
                  onclick="toggle(8);">
                
                <li class="pre-context-line"><code>      options[:default_encoding] ||= settings.default_encoding
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      # compile and render template
</code></li>
                
                <li class="pre-context-line"><code>      begin
</code></li>
                
                <li class="pre-context-line"><code>        layout_was      = @default_layout
</code></li>
                
                <li class="pre-context-line"><code>        @default_layout = false
</code></li>
                
                <li class="pre-context-line"><code>        template        = compile_template(engine, data, options, views)
</code></li>
                
              </ol>
              

              <ol start="871" class="context" id="8"
                  onclick="toggle(8);">
                <li class="context-line" id="context-8"><code>        output          = template.render(scope, locals, &amp;block)</code></li>
              </ol>

              
              <ol start="872" class="post-context"
                  id="post-8" onclick="toggle(8);">
                
                <li class="post-context-line"><code>      ensure
</code></li>
                
                <li class="post-context-line"><code>        @default_layout = layout_was
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      # render layout
</code></li>
                
                <li class="post-context-line"><code>      if layout
</code></li>
                
                <li class="post-context-line"><code>        extra_options = { views: views, layout: false, eat_errors: eat_errors, scope: scope }
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-contrib-4.0.0/lib/sinatra/engine_tracking.rb</code> in
                <code><strong>block in render</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="90"
                  class="pre-context" id="pre-9"
                  onclick="toggle(9);">
                
                <li class="pre-context-line"><code>    ensure
</code></li>
                
                <li class="pre-context-line"><code>      @current_engine = engine_was
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    private
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    def render(engine, *)
</code></li>
                
              </ol>
              

              <ol start="97" class="context" id="9"
                  onclick="toggle(9);">
                <li class="context-line" id="context-9"><code>      with_engine(engine) { super }</code></li>
              </ol>

              
              <ol start="98" class="post-context"
                  id="post-9" onclick="toggle(9);">
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>  end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>  helpers EngineTracking
</code></li>
                
                <li class="post-context-line"><code>end
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-contrib-4.0.0/lib/sinatra/engine_tracking.rb</code> in
                <code><strong>with_engine</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="82"
                  class="pre-context" id="pre-10"
                  onclick="toggle(10);">
                
                <li class="pre-context-line"><code>      super
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    # @param engine [Symbol, String] Name of Engine to shift to.
</code></li>
                
                <li class="pre-context-line"><code>    def with_engine(engine)
</code></li>
                
                <li class="pre-context-line"><code>      engine_was = @current_engine
</code></li>
                
                <li class="pre-context-line"><code>      @current_engine = engine.to_sym
</code></li>
                
              </ol>
              

              <ol start="89" class="context" id="10"
                  onclick="toggle(10);">
                <li class="context-line" id="context-10"><code>      yield</code></li>
              </ol>

              
              <ol start="90" class="post-context"
                  id="post-10" onclick="toggle(10);">
                
                <li class="post-context-line"><code>    ensure
</code></li>
                
                <li class="post-context-line"><code>      @current_engine = engine_was
</code></li>
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>    private
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>    def render(engine, *)
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-contrib-4.0.0/lib/sinatra/engine_tracking.rb</code> in
                <code><strong>render</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="90"
                  class="pre-context" id="pre-11"
                  onclick="toggle(11);">
                
                <li class="pre-context-line"><code>    ensure
</code></li>
                
                <li class="pre-context-line"><code>      @current_engine = engine_was
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    private
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    def render(engine, *)
</code></li>
                
              </ol>
              

              <ol start="97" class="context" id="11"
                  onclick="toggle(11);">
                <li class="context-line" id="context-11"><code>      with_engine(engine) { super }</code></li>
              </ol>

              
              <ol start="98" class="post-context"
                  id="post-11" onclick="toggle(11);">
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>  end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>  helpers EngineTracking
</code></li>
                
                <li class="post-context-line"><code>end
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>slim</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="799"
                  class="pre-context" id="pre-12"
                  onclick="toggle(12);">
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    def nokogiri(template = nil, options = {}, locals = {}, &amp;block)
</code></li>
                
                <li class="pre-context-line"><code>      options[:default_content_type] = :xml
</code></li>
                
                <li class="pre-context-line"><code>      render_ruby(:nokogiri, template, options, locals, &amp;block)
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    def slim(template, options = {}, locals = {}, &amp;block)
</code></li>
                
              </ol>
              

              <ol start="806" class="context" id="12"
                  onclick="toggle(12);">
                <li class="context-line" id="context-12"><code>      render(:slim, template, options, locals, &amp;block)</code></li>
              </ol>

              
              <ol start="807" class="post-context"
                  id="post-12" onclick="toggle(12);">
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>    def yajl(template, options = {}, locals = {})
</code></li>
                
                <li class="post-context-line"><code>      options[:default_content_type] = :json
</code></li>
                
                <li class="post-context-line"><code>      render :yajl, template, options, locals
</code></li>
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info app">
              <code>/app/controllers/playlist.rb</code> in
                <code><strong>block in &lt;class:PlaylistPortal&gt;</strong></code>
            </li>

            <li class="code app">
              
              <ol start="171"
                  class="pre-context" id="pre-13"
                  onclick="toggle(13);">
                
                <li class="pre-context-line"><code>    File.open(ofile, &#39;w&#39;) do |fod|
</code></li>
                
                <li class="pre-context-line"><code>      fod.puts content.to_yaml
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>    Plog.info(&quot;Updating #{ofile}&quot;)
</code></li>
                
                <li class="pre-context-line"><code>    locals = { program: program, content: content, extra: extra,
</code></li>
                
                <li class="pre-context-line"><code>               playlists: Program.playlists, type: :list,
</code></li>
                
                <li class="pre-context-line"><code>               title: &quot;Music Program: #{program}&quot;, }
</code></li>
                
              </ol>
              

              <ol start="178" class="context" id="13"
                  onclick="toggle(13);">
                <li class="context-line" id="context-13"><code>    slim :program, locals: locals</code></li>
              </ol>

              
              <ol start="179" class="post-context"
                  id="post-13" onclick="toggle(13);">
                
                <li class="post-context-line"><code>  end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>  post &#39;/reorder/:program/:ordlist&#39; do |program, ordlist|
</code></li>
                
                <li class="post-context-line"><code>    if Program.new(program, all: true).reorder(ordlist)
</code></li>
                
                <li class="post-context-line"><code>      &#39;OK&#39;
</code></li>
                
                <li class="post-context-line"><code>    else
</code></li>
                
                <li class="post-context-line"><code>      [404, &#39;ERROR&#39;]
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1798"
                  class="pre-context" id="pre-14"
                  onclick="toggle(14);">
                
                <li class="pre-context-line"><code>        pattern                 = compile(path, route_mustermann_opts)
</code></li>
                
                <li class="pre-context-line"><code>        method_name             = &quot;#{verb} #{path}&quot;
</code></li>
                
                <li class="pre-context-line"><code>        unbound_method          = generate_method(method_name, &amp;block)
</code></li>
                
                <li class="pre-context-line"><code>        conditions = @conditions
</code></li>
                
                <li class="pre-context-line"><code>        @conditions = []
</code></li>
                
                <li class="pre-context-line"><code>        wrapper = block.arity.zero? ?
</code></li>
                
                <li class="pre-context-line"><code>          proc { |a, _p| unbound_method.bind(a).call } :
</code></li>
                
              </ol>
              

              <ol start="1805" class="context" id="14"
                  onclick="toggle(14);">
                <li class="context-line" id="context-14"><code>          proc { |a, p| unbound_method.bind(a).call(*p) }</code></li>
              </ol>

              
              <ol start="1806" class="post-context"
                  id="post-14" onclick="toggle(14);">
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>        [pattern, conditions, wrapper]
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      def compile(path, route_mustermann_opts = {})
</code></li>
                
                <li class="post-context-line"><code>        Mustermann.new(path, **mustermann_opts.merge(route_mustermann_opts))
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>block in compile!</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1798"
                  class="pre-context" id="pre-15"
                  onclick="toggle(15);">
                
                <li class="pre-context-line"><code>        pattern                 = compile(path, route_mustermann_opts)
</code></li>
                
                <li class="pre-context-line"><code>        method_name             = &quot;#{verb} #{path}&quot;
</code></li>
                
                <li class="pre-context-line"><code>        unbound_method          = generate_method(method_name, &amp;block)
</code></li>
                
                <li class="pre-context-line"><code>        conditions = @conditions
</code></li>
                
                <li class="pre-context-line"><code>        @conditions = []
</code></li>
                
                <li class="pre-context-line"><code>        wrapper = block.arity.zero? ?
</code></li>
                
                <li class="pre-context-line"><code>          proc { |a, _p| unbound_method.bind(a).call } :
</code></li>
                
              </ol>
              

              <ol start="1805" class="context" id="15"
                  onclick="toggle(15);">
                <li class="context-line" id="context-15"><code>          proc { |a, p| unbound_method.bind(a).call(*p) }</code></li>
              </ol>

              
              <ol start="1806" class="post-context"
                  id="post-15" onclick="toggle(15);">
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>        [pattern, conditions, wrapper]
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      def compile(path, route_mustermann_opts = {})
</code></li>
                
                <li class="post-context-line"><code>        Mustermann.new(path, **mustermann_opts.merge(route_mustermann_opts))
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>block (3 levels) in route!</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1064"
                  class="pre-context" id="pre-16"
                  onclick="toggle(16);">
                
                <li class="pre-context-line"><code>      routes = base.routes[@request.request_method]
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      routes&amp;.each do |pattern, conditions, block|
</code></li>
                
                <li class="pre-context-line"><code>        response.delete_header(&#39;content-type&#39;) unless @pinned_response
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>        returned_pass_block = process_route(pattern, conditions) do |*args|
</code></li>
                
                <li class="pre-context-line"><code>          env[&#39;sinatra.route&#39;] = &quot;#{@request.request_method} #{pattern}&quot;
</code></li>
                
              </ol>
              

              <ol start="1071" class="context" id="16"
                  onclick="toggle(16);">
                <li class="context-line" id="context-16"><code>          route_eval { block[*args] }</code></li>
              </ol>

              
              <ol start="1072" class="post-context"
                  id="post-16" onclick="toggle(16);">
                
                <li class="post-context-line"><code>        end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>        # don&#39;t wipe out pass_block in superclass
</code></li>
                
                <li class="post-context-line"><code>        pass_block = returned_pass_block if returned_pass_block
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      # Run routes defined in superclass.
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>route_eval</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1082"
                  class="pre-context" id="pre-17"
                  onclick="toggle(17);">
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      route_eval(&amp;pass_block) if pass_block
</code></li>
                
                <li class="pre-context-line"><code>      route_missing
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    # Run a route block and throw :halt with the result.
</code></li>
                
                <li class="pre-context-line"><code>    def route_eval
</code></li>
                
              </ol>
              

              <ol start="1089" class="context" id="17"
                  onclick="toggle(17);">
                <li class="context-line" id="context-17"><code>      throw :halt, yield</code></li>
              </ol>

              
              <ol start="1090" class="post-context"
                  id="post-17" onclick="toggle(17);">
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>    # If the current request matches pattern and conditions, fill params
</code></li>
                
                <li class="post-context-line"><code>    # with keys and call the given block.
</code></li>
                
                <li class="post-context-line"><code>    # Revert params afterwards.
</code></li>
                
                <li class="post-context-line"><code>    #
</code></li>
                
                <li class="post-context-line"><code>    # Returns pass block.
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>block (2 levels) in route!</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1064"
                  class="pre-context" id="pre-18"
                  onclick="toggle(18);">
                
                <li class="pre-context-line"><code>      routes = base.routes[@request.request_method]
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      routes&amp;.each do |pattern, conditions, block|
</code></li>
                
                <li class="pre-context-line"><code>        response.delete_header(&#39;content-type&#39;) unless @pinned_response
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>        returned_pass_block = process_route(pattern, conditions) do |*args|
</code></li>
                
                <li class="pre-context-line"><code>          env[&#39;sinatra.route&#39;] = &quot;#{@request.request_method} #{pattern}&quot;
</code></li>
                
              </ol>
              

              <ol start="1071" class="context" id="18"
                  onclick="toggle(18);">
                <li class="context-line" id="context-18"><code>          route_eval { block[*args] }</code></li>
              </ol>

              
              <ol start="1072" class="post-context"
                  id="post-18" onclick="toggle(18);">
                
                <li class="post-context-line"><code>        end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>        # don&#39;t wipe out pass_block in superclass
</code></li>
                
                <li class="post-context-line"><code>        pass_block = returned_pass_block if returned_pass_block
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      # Run routes defined in superclass.
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>block in process_route</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1113"
                  class="pre-context" id="pre-19"
                  onclick="toggle(19);">
                
                <li class="pre-context-line"><code>        @params[:captures] = force_encoding(captures) unless captures.nil? || captures.empty?
</code></li>
                
                <li class="pre-context-line"><code>      else
</code></li>
                
                <li class="pre-context-line"><code>        values += params.values.flatten
</code></li>
                
                <li class="pre-context-line"><code>      end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      catch(:pass) do
</code></li>
                
                <li class="pre-context-line"><code>        conditions.each { |c| throw :pass if c.bind(self).call == false }
</code></li>
                
              </ol>
              

              <ol start="1120" class="context" id="19"
                  onclick="toggle(19);">
                <li class="context-line" id="context-19"><code>        block ? block[self, values] : yield(self, values)</code></li>
              </ol>

              
              <ol start="1121" class="post-context"
                  id="post-19" onclick="toggle(19);">
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>    rescue StandardError
</code></li>
                
                <li class="post-context-line"><code>      @env[&#39;sinatra.error.params&#39;] = @params
</code></li>
                
                <li class="post-context-line"><code>      raise
</code></li>
                
                <li class="post-context-line"><code>    ensure
</code></li>
                
                <li class="post-context-line"><code>      params ||= {}
</code></li>
                
                <li class="post-context-line"><code>      params.each { |k, _| @params.delete(k) } unless @env[&#39;sinatra.error.params&#39;]
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>catch</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1111"
                  class="pre-context" id="pre-20"
                  onclick="toggle(20);">
                
                <li class="pre-context-line"><code>        captures           = pattern.match(route).captures.map { |c| URI_INSTANCE.unescape(c) if c }
</code></li>
                
                <li class="pre-context-line"><code>        values            += captures
</code></li>
                
                <li class="pre-context-line"><code>        @params[:captures] = force_encoding(captures) unless captures.nil? || captures.empty?
</code></li>
                
                <li class="pre-context-line"><code>      else
</code></li>
                
                <li class="pre-context-line"><code>        values += params.values.flatten
</code></li>
                
                <li class="pre-context-line"><code>      end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
              </ol>
              

              <ol start="1118" class="context" id="20"
                  onclick="toggle(20);">
                <li class="context-line" id="context-20"><code>      catch(:pass) do</code></li>
              </ol>

              
              <ol start="1119" class="post-context"
                  id="post-20" onclick="toggle(20);">
                
                <li class="post-context-line"><code>        conditions.each { |c| throw :pass if c.bind(self).call == false }
</code></li>
                
                <li class="post-context-line"><code>        block ? block[self, values] : yield(self, values)
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>    rescue StandardError
</code></li>
                
                <li class="post-context-line"><code>      @env[&#39;sinatra.error.params&#39;] = @params
</code></li>
                
                <li class="post-context-line"><code>      raise
</code></li>
                
                <li class="post-context-line"><code>    ensure
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>process_route</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1111"
                  class="pre-context" id="pre-21"
                  onclick="toggle(21);">
                
                <li class="pre-context-line"><code>        captures           = pattern.match(route).captures.map { |c| URI_INSTANCE.unescape(c) if c }
</code></li>
                
                <li class="pre-context-line"><code>        values            += captures
</code></li>
                
                <li class="pre-context-line"><code>        @params[:captures] = force_encoding(captures) unless captures.nil? || captures.empty?
</code></li>
                
                <li class="pre-context-line"><code>      else
</code></li>
                
                <li class="pre-context-line"><code>        values += params.values.flatten
</code></li>
                
                <li class="pre-context-line"><code>      end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
              </ol>
              

              <ol start="1118" class="context" id="21"
                  onclick="toggle(21);">
                <li class="context-line" id="context-21"><code>      catch(:pass) do</code></li>
              </ol>

              
              <ol start="1119" class="post-context"
                  id="post-21" onclick="toggle(21);">
                
                <li class="post-context-line"><code>        conditions.each { |c| throw :pass if c.bind(self).call == false }
</code></li>
                
                <li class="post-context-line"><code>        block ? block[self, values] : yield(self, values)
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>    rescue StandardError
</code></li>
                
                <li class="post-context-line"><code>      @env[&#39;sinatra.error.params&#39;] = @params
</code></li>
                
                <li class="post-context-line"><code>      raise
</code></li>
                
                <li class="post-context-line"><code>    ensure
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>block in route!</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1062"
                  class="pre-context" id="pre-22"
                  onclick="toggle(22);">
                
                <li class="pre-context-line"><code>    # Run routes defined on the class and all superclasses.
</code></li>
                
                <li class="pre-context-line"><code>    def route!(base = settings, pass_block = nil)
</code></li>
                
                <li class="pre-context-line"><code>      routes = base.routes[@request.request_method]
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      routes&amp;.each do |pattern, conditions, block|
</code></li>
                
                <li class="pre-context-line"><code>        response.delete_header(&#39;content-type&#39;) unless @pinned_response
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
              </ol>
              

              <ol start="1069" class="context" id="22"
                  onclick="toggle(22);">
                <li class="context-line" id="context-22"><code>        returned_pass_block = process_route(pattern, conditions) do |*args|</code></li>
              </ol>

              
              <ol start="1070" class="post-context"
                  id="post-22" onclick="toggle(22);">
                
                <li class="post-context-line"><code>          env[&#39;sinatra.route&#39;] = &quot;#{@request.request_method} #{pattern}&quot;
</code></li>
                
                <li class="post-context-line"><code>          route_eval { block[*args] }
</code></li>
                
                <li class="post-context-line"><code>        end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>        # don&#39;t wipe out pass_block in superclass
</code></li>
                
                <li class="post-context-line"><code>        pass_block = returned_pass_block if returned_pass_block
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>each</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1059"
                  class="pre-context" id="pre-23"
                  onclick="toggle(23);">
                
                <li class="pre-context-line"><code>      end
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    # Run routes defined on the class and all superclasses.
</code></li>
                
                <li class="pre-context-line"><code>    def route!(base = settings, pass_block = nil)
</code></li>
                
                <li class="pre-context-line"><code>      routes = base.routes[@request.request_method]
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
              </ol>
              

              <ol start="1066" class="context" id="23"
                  onclick="toggle(23);">
                <li class="context-line" id="context-23"><code>      routes&amp;.each do |pattern, conditions, block|</code></li>
              </ol>

              
              <ol start="1067" class="post-context"
                  id="post-23" onclick="toggle(23);">
                
                <li class="post-context-line"><code>        response.delete_header(&#39;content-type&#39;) unless @pinned_response
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>        returned_pass_block = process_route(pattern, conditions) do |*args|
</code></li>
                
                <li class="post-context-line"><code>          env[&#39;sinatra.route&#39;] = &quot;#{@request.request_method} #{pattern}&quot;
</code></li>
                
                <li class="post-context-line"><code>          route_eval { block[*args] }
</code></li>
                
                <li class="post-context-line"><code>        end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>route!</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1059"
                  class="pre-context" id="pre-24"
                  onclick="toggle(24);">
                
                <li class="pre-context-line"><code>      end
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    # Run routes defined on the class and all superclasses.
</code></li>
                
                <li class="pre-context-line"><code>    def route!(base = settings, pass_block = nil)
</code></li>
                
                <li class="pre-context-line"><code>      routes = base.routes[@request.request_method]
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
              </ol>
              

              <ol start="1066" class="context" id="24"
                  onclick="toggle(24);">
                <li class="context-line" id="context-24"><code>      routes&amp;.each do |pattern, conditions, block|</code></li>
              </ol>

              
              <ol start="1067" class="post-context"
                  id="post-24" onclick="toggle(24);">
                
                <li class="post-context-line"><code>        response.delete_header(&#39;content-type&#39;) unless @pinned_response
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>        returned_pass_block = process_route(pattern, conditions) do |*args|
</code></li>
                
                <li class="post-context-line"><code>          env[&#39;sinatra.route&#39;] = &quot;#{@request.request_method} #{pattern}&quot;
</code></li>
                
                <li class="post-context-line"><code>          route_eval { block[*args] }
</code></li>
                
                <li class="post-context-line"><code>        end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>block in dispatch!</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1183"
                  class="pre-context" id="pre-25"
                  onclick="toggle(25);">
                
                <li class="pre-context-line"><code>      end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      invoke do
</code></li>
                
                <li class="pre-context-line"><code>        static! if settings.static? &amp;&amp; (request.get? || request.head?)
</code></li>
                
                <li class="pre-context-line"><code>        filter! :before do
</code></li>
                
                <li class="pre-context-line"><code>          @pinned_response = !response[&#39;content-type&#39;].nil?
</code></li>
                
                <li class="pre-context-line"><code>        end
</code></li>
                
              </ol>
              

              <ol start="1190" class="context" id="25"
                  onclick="toggle(25);">
                <li class="context-line" id="context-25"><code>        route!</code></li>
              </ol>

              
              <ol start="1191" class="post-context"
                  id="post-25" onclick="toggle(25);">
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>    rescue ::Exception =&gt; e
</code></li>
                
                <li class="post-context-line"><code>      invoke { handle_exception!(e) }
</code></li>
                
                <li class="post-context-line"><code>    ensure
</code></li>
                
                <li class="post-context-line"><code>      begin
</code></li>
                
                <li class="post-context-line"><code>        filter! :after unless env[&#39;sinatra.static_file&#39;]
</code></li>
                
                <li class="post-context-line"><code>      rescue ::Exception =&gt; e
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>catch</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1154"
                  class="pre-context" id="pre-26"
                  onclick="toggle(26);">
                
                <li class="pre-context-line"><code>      env[&#39;sinatra.static_file&#39;] = path
</code></li>
                
                <li class="pre-context-line"><code>      cache_control(*settings.static_cache_control) if settings.static_cache_control?
</code></li>
                
                <li class="pre-context-line"><code>      send_file path, options.merge(disposition: nil)
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    # Run the block with &#39;throw :halt&#39; support and apply result to the response.
</code></li>
                
                <li class="pre-context-line"><code>    def invoke(&amp;block)
</code></li>
                
              </ol>
              

              <ol start="1161" class="context" id="26"
                  onclick="toggle(26);">
                <li class="context-line" id="context-26"><code>      res = catch(:halt, &amp;block)</code></li>
              </ol>

              
              <ol start="1162" class="post-context"
                  id="post-26" onclick="toggle(26);">
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      res = [res] if (Integer === res) || (String === res)
</code></li>
                
                <li class="post-context-line"><code>      if (Array === res) &amp;&amp; (Integer === res.first)
</code></li>
                
                <li class="post-context-line"><code>        res = res.dup
</code></li>
                
                <li class="post-context-line"><code>        status(res.shift)
</code></li>
                
                <li class="post-context-line"><code>        body(res.pop)
</code></li>
                
                <li class="post-context-line"><code>        headers(*res)
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>invoke</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1154"
                  class="pre-context" id="pre-27"
                  onclick="toggle(27);">
                
                <li class="pre-context-line"><code>      env[&#39;sinatra.static_file&#39;] = path
</code></li>
                
                <li class="pre-context-line"><code>      cache_control(*settings.static_cache_control) if settings.static_cache_control?
</code></li>
                
                <li class="pre-context-line"><code>      send_file path, options.merge(disposition: nil)
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    # Run the block with &#39;throw :halt&#39; support and apply result to the response.
</code></li>
                
                <li class="pre-context-line"><code>    def invoke(&amp;block)
</code></li>
                
              </ol>
              

              <ol start="1161" class="context" id="27"
                  onclick="toggle(27);">
                <li class="context-line" id="context-27"><code>      res = catch(:halt, &amp;block)</code></li>
              </ol>

              
              <ol start="1162" class="post-context"
                  id="post-27" onclick="toggle(27);">
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      res = [res] if (Integer === res) || (String === res)
</code></li>
                
                <li class="post-context-line"><code>      if (Array === res) &amp;&amp; (Integer === res.first)
</code></li>
                
                <li class="post-context-line"><code>        res = res.dup
</code></li>
                
                <li class="post-context-line"><code>        status(res.shift)
</code></li>
                
                <li class="post-context-line"><code>        body(res.pop)
</code></li>
                
                <li class="post-context-line"><code>        headers(*res)
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>dispatch!</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1178"
                  class="pre-context" id="pre-28"
                  onclick="toggle(28);">
                
                <li class="pre-context-line"><code>      @params.merge!(@request.params).each do |key, val|
</code></li>
                
                <li class="pre-context-line"><code>        next unless val.respond_to?(:force_encoding)
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>        val = val.dup if val.frozen?
</code></li>
                
                <li class="pre-context-line"><code>        @params[key] = force_encoding(val)
</code></li>
                
                <li class="pre-context-line"><code>      end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
              </ol>
              

              <ol start="1185" class="context" id="28"
                  onclick="toggle(28);">
                <li class="context-line" id="context-28"><code>      invoke do</code></li>
              </ol>

              
              <ol start="1186" class="post-context"
                  id="post-28" onclick="toggle(28);">
                
                <li class="post-context-line"><code>        static! if settings.static? &amp;&amp; (request.get? || request.head?)
</code></li>
                
                <li class="post-context-line"><code>        filter! :before do
</code></li>
                
                <li class="post-context-line"><code>          @pinned_response = !response[&#39;content-type&#39;].nil?
</code></li>
                
                <li class="post-context-line"><code>        end
</code></li>
                
                <li class="post-context-line"><code>        route!
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>    rescue ::Exception =&gt; e
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>block in call!</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="994"
                  class="pre-context" id="pre-29"
                  onclick="toggle(29);">
                
                <li class="pre-context-line"><code>      @env      = env
</code></li>
                
                <li class="pre-context-line"><code>      @params   = IndifferentHash.new
</code></li>
                
                <li class="pre-context-line"><code>      @request  = Request.new(env)
</code></li>
                
                <li class="pre-context-line"><code>      @response = Response.new
</code></li>
                
                <li class="pre-context-line"><code>      @pinned_response = nil
</code></li>
                
                <li class="pre-context-line"><code>      template_cache.clear if settings.reload_templates
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
              </ol>
              

              <ol start="1001" class="context" id="29"
                  onclick="toggle(29);">
                <li class="context-line" id="context-29"><code>      invoke { dispatch! }</code></li>
              </ol>

              
              <ol start="1002" class="post-context"
                  id="post-29" onclick="toggle(29);">
                
                <li class="post-context-line"><code>      invoke { error_block!(response.status) } unless @env[&#39;sinatra.error&#39;]
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      unless @response[&#39;content-type&#39;]
</code></li>
                
                <li class="post-context-line"><code>        if Array === body &amp;&amp; body[0].respond_to?(:content_type)
</code></li>
                
                <li class="post-context-line"><code>          content_type body[0].content_type
</code></li>
                
                <li class="post-context-line"><code>        elsif (default = settings.default_content_type)
</code></li>
                
                <li class="post-context-line"><code>          content_type default
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>catch</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1154"
                  class="pre-context" id="pre-30"
                  onclick="toggle(30);">
                
                <li class="pre-context-line"><code>      env[&#39;sinatra.static_file&#39;] = path
</code></li>
                
                <li class="pre-context-line"><code>      cache_control(*settings.static_cache_control) if settings.static_cache_control?
</code></li>
                
                <li class="pre-context-line"><code>      send_file path, options.merge(disposition: nil)
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    # Run the block with &#39;throw :halt&#39; support and apply result to the response.
</code></li>
                
                <li class="pre-context-line"><code>    def invoke(&amp;block)
</code></li>
                
              </ol>
              

              <ol start="1161" class="context" id="30"
                  onclick="toggle(30);">
                <li class="context-line" id="context-30"><code>      res = catch(:halt, &amp;block)</code></li>
              </ol>

              
              <ol start="1162" class="post-context"
                  id="post-30" onclick="toggle(30);">
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      res = [res] if (Integer === res) || (String === res)
</code></li>
                
                <li class="post-context-line"><code>      if (Array === res) &amp;&amp; (Integer === res.first)
</code></li>
                
                <li class="post-context-line"><code>        res = res.dup
</code></li>
                
                <li class="post-context-line"><code>        status(res.shift)
</code></li>
                
                <li class="post-context-line"><code>        body(res.pop)
</code></li>
                
                <li class="post-context-line"><code>        headers(*res)
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>invoke</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="1154"
                  class="pre-context" id="pre-31"
                  onclick="toggle(31);">
                
                <li class="pre-context-line"><code>      env[&#39;sinatra.static_file&#39;] = path
</code></li>
                
                <li class="pre-context-line"><code>      cache_control(*settings.static_cache_control) if settings.static_cache_control?
</code></li>
                
                <li class="pre-context-line"><code>      send_file path, options.merge(disposition: nil)
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    # Run the block with &#39;throw :halt&#39; support and apply result to the response.
</code></li>
                
                <li class="pre-context-line"><code>    def invoke(&amp;block)
</code></li>
                
              </ol>
              

              <ol start="1161" class="context" id="31"
                  onclick="toggle(31);">
                <li class="context-line" id="context-31"><code>      res = catch(:halt, &amp;block)</code></li>
              </ol>

              
              <ol start="1162" class="post-context"
                  id="post-31" onclick="toggle(31);">
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      res = [res] if (Integer === res) || (String === res)
</code></li>
                
                <li class="post-context-line"><code>      if (Array === res) &amp;&amp; (Integer === res.first)
</code></li>
                
                <li class="post-context-line"><code>        res = res.dup
</code></li>
                
                <li class="post-context-line"><code>        status(res.shift)
</code></li>
                
                <li class="post-context-line"><code>        body(res.pop)
</code></li>
                
                <li class="post-context-line"><code>        headers(*res)
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>call!</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="994"
                  class="pre-context" id="pre-32"
                  onclick="toggle(32);">
                
                <li class="pre-context-line"><code>      @env      = env
</code></li>
                
                <li class="pre-context-line"><code>      @params   = IndifferentHash.new
</code></li>
                
                <li class="pre-context-line"><code>      @request  = Request.new(env)
</code></li>
                
                <li class="pre-context-line"><code>      @response = Response.new
</code></li>
                
                <li class="pre-context-line"><code>      @pinned_response = nil
</code></li>
                
                <li class="pre-context-line"><code>      template_cache.clear if settings.reload_templates
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
              </ol>
              

              <ol start="1001" class="context" id="32"
                  onclick="toggle(32);">
                <li class="context-line" id="context-32"><code>      invoke { dispatch! }</code></li>
              </ol>

              
              <ol start="1002" class="post-context"
                  id="post-32" onclick="toggle(32);">
                
                <li class="post-context-line"><code>      invoke { error_block!(response.status) } unless @env[&#39;sinatra.error&#39;]
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      unless @response[&#39;content-type&#39;]
</code></li>
                
                <li class="post-context-line"><code>        if Array === body &amp;&amp; body[0].respond_to?(:content_type)
</code></li>
                
                <li class="post-context-line"><code>          content_type body[0].content_type
</code></li>
                
                <li class="post-context-line"><code>        elsif (default = settings.default_content_type)
</code></li>
                
                <li class="post-context-line"><code>          content_type default
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="983"
                  class="pre-context" id="pre-33"
                  onclick="toggle(33);">
                
                <li class="pre-context-line"><code>      @template_cache = TemplateCache.new
</code></li>
                
                <li class="pre-context-line"><code>      @pinned_response = nil # whether a before! filter pinned the content-type
</code></li>
                
                <li class="pre-context-line"><code>      yield self if block_given?
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    # Rack call interface.
</code></li>
                
                <li class="pre-context-line"><code>    def call(env)
</code></li>
                
              </ol>
              

              <ol start="990" class="context" id="33"
                  onclick="toggle(33);">
                <li class="context-line" id="context-33"><code>      dup.call!(env)</code></li>
              </ol>

              
              <ol start="991" class="post-context"
                  id="post-33" onclick="toggle(33);">
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>    def call!(env) # :nodoc:
</code></li>
                
                <li class="post-context-line"><code>      @env      = env
</code></li>
                
                <li class="post-context-line"><code>      @params   = IndifferentHash.new
</code></li>
                
                <li class="post-context-line"><code>      @request  = Request.new(env)
</code></li>
                
                <li class="post-context-line"><code>      @response = Response.new
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-protection-4.0.0/lib/rack/protection/xss_header.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="13"
                  class="pre-context" id="pre-34"
                  onclick="toggle(34);">
                
                <li class="pre-context-line"><code>    #
</code></li>
                
                <li class="pre-context-line"><code>    # Options:
</code></li>
                
                <li class="pre-context-line"><code>    # xss_mode:: How the browser should prevent the attack (default: :block)
</code></li>
                
                <li class="pre-context-line"><code>    class XSSHeader &lt; Base
</code></li>
                
                <li class="pre-context-line"><code>      default_options xss_mode: :block, nosniff: true
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      def call(env)
</code></li>
                
              </ol>
              

              <ol start="20" class="context" id="34"
                  onclick="toggle(34);">
                <li class="context-line" id="context-34"><code>        status, headers, body = @app.call(env)</code></li>
              </ol>

              
              <ol start="21" class="post-context"
                  id="post-34" onclick="toggle(34);">
                
                <li class="post-context-line"><code>        headers[&#39;x-xss-protection&#39;]       ||= &quot;1; mode=#{options[:xss_mode]}&quot; if html? headers
</code></li>
                
                <li class="post-context-line"><code>        headers[&#39;x-content-type-options&#39;] ||= &#39;nosniff&#39;                       if options[:nosniff]
</code></li>
                
                <li class="post-context-line"><code>        [status, headers, body]
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>  end
</code></li>
                
                <li class="post-context-line"><code>end
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-protection-4.0.0/lib/rack/protection/base.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="46"
                  class="pre-context" id="pre-35"
                  onclick="toggle(35);">
                
                <li class="pre-context-line"><code>      end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      def call(env)
</code></li>
                
                <li class="pre-context-line"><code>        unless accepts? env
</code></li>
                
                <li class="pre-context-line"><code>          instrument env
</code></li>
                
                <li class="pre-context-line"><code>          result = react env
</code></li>
                
                <li class="pre-context-line"><code>        end
</code></li>
                
              </ol>
              

              <ol start="53" class="context" id="35"
                  onclick="toggle(35);">
                <li class="context-line" id="context-35"><code>        result or app.call(env)</code></li>
              </ol>

              
              <ol start="54" class="post-context"
                  id="post-35" onclick="toggle(35);">
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      def react(env)
</code></li>
                
                <li class="post-context-line"><code>        result = send(options[:reaction], env)
</code></li>
                
                <li class="post-context-line"><code>        result if (Array === result) &amp;&amp; (result.size == 3)
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-protection-4.0.0/lib/rack/protection/path_traversal.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="11"
                  class="pre-context" id="pre-36"
                  onclick="toggle(36);">
                
                <li class="pre-context-line"><code>    #
</code></li>
                
                <li class="pre-context-line"><code>    # Unescapes &#39;/&#39; and &#39;.&#39;, expands +path_info+.
</code></li>
                
                <li class="pre-context-line"><code>    # Thus &lt;tt&gt;GET /foo/%2e%2e%2fbar&lt;/tt&gt; becomes &lt;tt&gt;GET /bar&lt;/tt&gt;.
</code></li>
                
                <li class="pre-context-line"><code>    class PathTraversal &lt; Base
</code></li>
                
                <li class="pre-context-line"><code>      def call(env)
</code></li>
                
                <li class="pre-context-line"><code>        path_was         = env[&#39;PATH_INFO&#39;]
</code></li>
                
                <li class="pre-context-line"><code>        env[&#39;PATH_INFO&#39;] = cleanup path_was if path_was &amp;&amp; !path_was.empty?
</code></li>
                
              </ol>
              

              <ol start="18" class="context" id="36"
                  onclick="toggle(36);">
                <li class="context-line" id="context-36"><code>        app.call env</code></li>
              </ol>

              
              <ol start="19" class="post-context"
                  id="post-36" onclick="toggle(36);">
                
                <li class="post-context-line"><code>      ensure
</code></li>
                
                <li class="post-context-line"><code>        env[&#39;PATH_INFO&#39;] = path_was
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      def cleanup(path)
</code></li>
                
                <li class="post-context-line"><code>        encoding = path.encoding
</code></li>
                
                <li class="post-context-line"><code>        dot   = &#39;.&#39;.encode(encoding)
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-protection-4.0.0/lib/rack/protection/json_csrf.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="21"
                  class="pre-context" id="pre-37"
                  onclick="toggle(37);">
                
                <li class="pre-context-line"><code>    class JsonCsrf &lt; Base
</code></li>
                
                <li class="pre-context-line"><code>      default_options allow_if: nil
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      alias react deny
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      def call(env)
</code></li>
                
                <li class="pre-context-line"><code>        request               = Request.new(env)
</code></li>
                
              </ol>
              

              <ol start="28" class="context" id="37"
                  onclick="toggle(37);">
                <li class="context-line" id="context-37"><code>        status, headers, body = app.call(env)</code></li>
              </ol>

              
              <ol start="29" class="post-context"
                  id="post-37" onclick="toggle(37);">
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>        if has_vector?(request, headers)
</code></li>
                
                <li class="post-context-line"><code>          warn env, &quot;attack prevented by #{self.class}&quot;
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>          react_and_close(env, body) or [status, headers, body]
</code></li>
                
                <li class="post-context-line"><code>        else
</code></li>
                
                <li class="post-context-line"><code>          [status, headers, body]
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-protection-4.0.0/lib/rack/protection/base.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="46"
                  class="pre-context" id="pre-38"
                  onclick="toggle(38);">
                
                <li class="pre-context-line"><code>      end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      def call(env)
</code></li>
                
                <li class="pre-context-line"><code>        unless accepts? env
</code></li>
                
                <li class="pre-context-line"><code>          instrument env
</code></li>
                
                <li class="pre-context-line"><code>          result = react env
</code></li>
                
                <li class="pre-context-line"><code>        end
</code></li>
                
              </ol>
              

              <ol start="53" class="context" id="38"
                  onclick="toggle(38);">
                <li class="context-line" id="context-38"><code>        result or app.call(env)</code></li>
              </ol>

              
              <ol start="54" class="post-context"
                  id="post-38" onclick="toggle(38);">
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      def react(env)
</code></li>
                
                <li class="post-context-line"><code>        result = send(options[:reaction], env)
</code></li>
                
                <li class="post-context-line"><code>        result if (Array === result) &amp;&amp; (result.size == 3)
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-protection-4.0.0/lib/rack/protection/base.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="46"
                  class="pre-context" id="pre-39"
                  onclick="toggle(39);">
                
                <li class="pre-context-line"><code>      end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      def call(env)
</code></li>
                
                <li class="pre-context-line"><code>        unless accepts? env
</code></li>
                
                <li class="pre-context-line"><code>          instrument env
</code></li>
                
                <li class="pre-context-line"><code>          result = react env
</code></li>
                
                <li class="pre-context-line"><code>        end
</code></li>
                
              </ol>
              

              <ol start="53" class="context" id="39"
                  onclick="toggle(39);">
                <li class="context-line" id="context-39"><code>        result or app.call(env)</code></li>
              </ol>

              
              <ol start="54" class="post-context"
                  id="post-39" onclick="toggle(39);">
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      def react(env)
</code></li>
                
                <li class="post-context-line"><code>        result = send(options[:reaction], env)
</code></li>
                
                <li class="post-context-line"><code>        result if (Array === result) &amp;&amp; (result.size == 3)
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-protection-4.0.0/lib/rack/protection/frame_options.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="26"
                  class="pre-context" id="pre-40"
                  onclick="toggle(40);">
                
                <li class="pre-context-line"><code>          frame_options = options[:frame_options]
</code></li>
                
                <li class="pre-context-line"><code>          frame_options = options[:frame_options].to_s.upcase unless frame_options.respond_to? :to_str
</code></li>
                
                <li class="pre-context-line"><code>          frame_options.to_str
</code></li>
                
                <li class="pre-context-line"><code>        end
</code></li>
                
                <li class="pre-context-line"><code>      end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      def call(env)
</code></li>
                
              </ol>
              

              <ol start="33" class="context" id="40"
                  onclick="toggle(40);">
                <li class="context-line" id="context-40"><code>        status, headers, body        = @app.call(env)</code></li>
              </ol>

              
              <ol start="34" class="post-context"
                  id="post-40" onclick="toggle(40);">
                
                <li class="post-context-line"><code>        headers[&#39;x-frame-options&#39;] ||= frame_options if html? headers
</code></li>
                
                <li class="post-context-line"><code>        [status, headers, body]
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>  end
</code></li>
                
                <li class="post-context-line"><code>end
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-session-2.0.0/lib/rack/session/abstract/id.rb</code> in
                <code><strong>context</strong></code>
            </li>

            <li class="code system">
              
              <ol start="265"
                  class="pre-context" id="pre-41"
                  onclick="toggle(41);">
                
                <li class="pre-context-line"><code>        def call(env)
</code></li>
                
                <li class="pre-context-line"><code>          context(env)
</code></li>
                
                <li class="pre-context-line"><code>        end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>        def context(env, app = @app)
</code></li>
                
                <li class="pre-context-line"><code>          req = make_request env
</code></li>
                
                <li class="pre-context-line"><code>          prepare_session(req)
</code></li>
                
              </ol>
              

              <ol start="272" class="context" id="41"
                  onclick="toggle(41);">
                <li class="context-line" id="context-41"><code>          status, headers, body = app.call(req.env)</code></li>
              </ol>

              
              <ol start="273" class="post-context"
                  id="post-41" onclick="toggle(41);">
                
                <li class="post-context-line"><code>          res = Rack::Response::Raw.new status, headers
</code></li>
                
                <li class="post-context-line"><code>          commit_session(req, res)
</code></li>
                
                <li class="post-context-line"><code>          [status, headers, body]
</code></li>
                
                <li class="post-context-line"><code>        end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>        private
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-session-2.0.0/lib/rack/session/abstract/id.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="259"
                  class="pre-context" id="pre-42"
                  onclick="toggle(42);">
                
                <li class="pre-context-line"><code>          @key = @default_options.delete(:key)
</code></li>
                
                <li class="pre-context-line"><code>          @cookie_only = @default_options.delete(:cookie_only)
</code></li>
                
                <li class="pre-context-line"><code>          @same_site = @default_options.delete(:same_site)
</code></li>
                
                <li class="pre-context-line"><code>          initialize_sid
</code></li>
                
                <li class="pre-context-line"><code>        end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>        def call(env)
</code></li>
                
              </ol>
              

              <ol start="266" class="context" id="42"
                  onclick="toggle(42);">
                <li class="context-line" id="context-42"><code>          context(env)</code></li>
              </ol>

              
              <ol start="267" class="post-context"
                  id="post-42" onclick="toggle(42);">
                
                <li class="post-context-line"><code>        end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>        def context(env, app = @app)
</code></li>
                
                <li class="post-context-line"><code>          req = make_request env
</code></li>
                
                <li class="post-context-line"><code>          prepare_session(req)
</code></li>
                
                <li class="post-context-line"><code>          status, headers, body = app.call(req.env)
</code></li>
                
                <li class="post-context-line"><code>          res = Rack::Response::Raw.new status, headers
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-3.1.8/lib/rack/null_logger.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="6"
                  class="pre-context" id="pre-43"
                  onclick="toggle(43);">
                
                <li class="pre-context-line"><code>  class NullLogger
</code></li>
                
                <li class="pre-context-line"><code>    def initialize(app)
</code></li>
                
                <li class="pre-context-line"><code>      @app = app
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    def call(env)
</code></li>
                
                <li class="pre-context-line"><code>      env[RACK_LOGGER] = self
</code></li>
                
              </ol>
              

              <ol start="13" class="context" id="43"
                  onclick="toggle(43);">
                <li class="context-line" id="context-43"><code>      @app.call(env)</code></li>
              </ol>

              
              <ol start="14" class="post-context"
                  id="post-43" onclick="toggle(43);">
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>    def info(progname = nil, &amp;block); end
</code></li>
                
                <li class="post-context-line"><code>    def debug(progname = nil, &amp;block); end
</code></li>
                
                <li class="post-context-line"><code>    def warn(progname = nil, &amp;block); end
</code></li>
                
                <li class="post-context-line"><code>    def error(progname = nil, &amp;block); end
</code></li>
                
                <li class="post-context-line"><code>    def fatal(progname = nil, &amp;block); end
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-3.1.8/lib/rack/head.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="8"
                  class="pre-context" id="pre-44"
                  onclick="toggle(44);">
                
                <li class="pre-context-line"><code>  # all other requests unchanged.
</code></li>
                
                <li class="pre-context-line"><code>  class Head
</code></li>
                
                <li class="pre-context-line"><code>    def initialize(app)
</code></li>
                
                <li class="pre-context-line"><code>      @app = app
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    def call(env)
</code></li>
                
              </ol>
              

              <ol start="15" class="context" id="44"
                  onclick="toggle(44);">
                <li class="context-line" id="context-44"><code>      _, _, body = response = @app.call(env)</code></li>
              </ol>

              
              <ol start="16" class="post-context"
                  id="post-44" onclick="toggle(44);">
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      if env[REQUEST_METHOD] == HEAD
</code></li>
                
                <li class="post-context-line"><code>        response[2] = Rack::BodyProxy.new([]) do
</code></li>
                
                <li class="post-context-line"><code>          body.close if body.respond_to? :close
</code></li>
                
                <li class="post-context-line"><code>        end
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/show_exceptions.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="16"
                  class="pre-context" id="pre-45"
                  onclick="toggle(45);">
                
                <li class="pre-context-line"><code>    def @@eats_errors.puts(*) end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    def initialize(app)
</code></li>
                
                <li class="pre-context-line"><code>      @app = app
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    def call(env)
</code></li>
                
              </ol>
              

              <ol start="23" class="context" id="45"
                  onclick="toggle(45);">
                <li class="context-line" id="context-45"><code>      @app.call(env)</code></li>
              </ol>

              
              <ol start="24" class="post-context"
                  id="post-45" onclick="toggle(45);">
                
                <li class="post-context-line"><code>    rescue Exception =&gt; e
</code></li>
                
                <li class="post-context-line"><code>      errors = env[&#39;rack.errors&#39;]
</code></li>
                
                <li class="post-context-line"><code>      env[&#39;rack.errors&#39;] = @@eats_errors
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      if prefers_plain_text?(env)
</code></li>
                
                <li class="post-context-line"><code>        content_type = &#39;text/plain&#39;
</code></li>
                
                <li class="post-context-line"><code>        body = dump_exception(e)
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="217"
                  class="pre-context" id="pre-46"
                  onclick="toggle(46);">
                
                <li class="pre-context-line"><code>  # Some Rack handlers implement an extended body object protocol, however,
</code></li>
                
                <li class="pre-context-line"><code>  # some middleware (namely Rack::Lint) will break it by not mirroring the methods in question.
</code></li>
                
                <li class="pre-context-line"><code>  # This middleware will detect an extended body object and will make sure it reaches the
</code></li>
                
                <li class="pre-context-line"><code>  # handler directly. We do this here, so our middleware and middleware set up by the app will
</code></li>
                
                <li class="pre-context-line"><code>  # still be able to run.
</code></li>
                
                <li class="pre-context-line"><code>  class ExtendedRack &lt; Struct.new(:app)
</code></li>
                
                <li class="pre-context-line"><code>    def call(env)
</code></li>
                
              </ol>
              

              <ol start="224" class="context" id="46"
                  onclick="toggle(46);">
                <li class="context-line" id="context-46"><code>      result = app.call(env)</code></li>
              </ol>

              
              <ol start="225" class="post-context"
                  id="post-46" onclick="toggle(46);">
                
                <li class="post-context-line"><code>      callback = env[&#39;async.callback&#39;]
</code></li>
                
                <li class="post-context-line"><code>      return result unless callback &amp;&amp; async?(*result)
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      after_response { callback.call result }
</code></li>
                
                <li class="post-context-line"><code>      setup_close(env, *result)
</code></li>
                
                <li class="post-context-line"><code>      throw :async
</code></li>
                
                <li class="post-context-line"><code>    end
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info framework">
              <code>/usr/lib/ruby/gems/3.2.0/gems/sinatra-4.0.0/lib/sinatra/base.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code framework">
              
              <ol start="2108"
                  class="pre-context" id="pre-47"
                  onclick="toggle(47);">
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    def helpers
</code></li>
                
                <li class="pre-context-line"><code>      @instance
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    def call(env)
</code></li>
                
              </ol>
              

              <ol start="2115" class="context" id="47"
                  onclick="toggle(47);">
                <li class="context-line" id="context-47"><code>      @stack.call(env)</code></li>
              </ol>

              
              <ol start="2116" class="post-context"
                  id="post-47" onclick="toggle(47);">
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>    def inspect
</code></li>
                
                <li class="post-context-line"><code>      &quot;#&lt;#{@instance.class} app_file=#{settings.app_file.inspect}&gt;&quot;
</code></li>
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>  end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-3.1.8/lib/rack/urlmap.rb</code> in
                <code><strong>block in call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="69"
                  class="pre-context" id="pre-48"
                  onclick="toggle(48);">
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>        rest = m[1]
</code></li>
                
                <li class="pre-context-line"><code>        next unless !rest || rest.empty? || rest[0] == ?/
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>        env[SCRIPT_NAME] = (script_name + location)
</code></li>
                
                <li class="pre-context-line"><code>        env[PATH_INFO] = rest
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
              </ol>
              

              <ol start="76" class="context" id="48"
                  onclick="toggle(48);">
                <li class="context-line" id="context-48"><code>        return app.call(env)</code></li>
              </ol>

              
              <ol start="77" class="post-context"
                  id="post-48" onclick="toggle(48);">
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      [404, { CONTENT_TYPE =&gt; &quot;text/plain&quot;, &quot;x-cascade&quot; =&gt; &quot;pass&quot; }, [&quot;Not Found: #{path}&quot;]]
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>    ensure
</code></li>
                
                <li class="post-context-line"><code>      env[PATH_INFO]   = path
</code></li>
                
                <li class="post-context-line"><code>      env[SCRIPT_NAME] = script_name
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-3.1.8/lib/rack/urlmap.rb</code> in
                <code><strong>each</strong></code>
            </li>

            <li class="code system">
              
              <ol start="53"
                  class="pre-context" id="pre-49"
                  onclick="toggle(49);">
                
                <li class="pre-context-line"><code>      server_port = env[SERVER_PORT]
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      is_same_server = casecmp?(http_host, server_name) ||
</code></li>
                
                <li class="pre-context-line"><code>                       casecmp?(http_host, &quot;#{server_name}:#{server_port}&quot;)
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      is_host_known = @known_hosts.include? http_host
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
              </ol>
              

              <ol start="60" class="context" id="49"
                  onclick="toggle(49);">
                <li class="context-line" id="context-49"><code>      @mapping.each do |host, location, match, app|</code></li>
              </ol>

              
              <ol start="61" class="post-context"
                  id="post-49" onclick="toggle(49);">
                
                <li class="post-context-line"><code>        unless casecmp?(http_host, host) \
</code></li>
                
                <li class="post-context-line"><code>            || casecmp?(server_name, host) \
</code></li>
                
                <li class="post-context-line"><code>            || (!host &amp;&amp; is_same_server) \
</code></li>
                
                <li class="post-context-line"><code>            || (!host &amp;&amp; !is_host_known) # If we don&#39;t have a matching host, default to the first without a specified host
</code></li>
                
                <li class="post-context-line"><code>          next
</code></li>
                
                <li class="post-context-line"><code>        end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-3.1.8/lib/rack/urlmap.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="53"
                  class="pre-context" id="pre-50"
                  onclick="toggle(50);">
                
                <li class="pre-context-line"><code>      server_port = env[SERVER_PORT]
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      is_same_server = casecmp?(http_host, server_name) ||
</code></li>
                
                <li class="pre-context-line"><code>                       casecmp?(http_host, &quot;#{server_name}:#{server_port}&quot;)
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      is_host_known = @known_hosts.include? http_host
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
              </ol>
              

              <ol start="60" class="context" id="50"
                  onclick="toggle(50);">
                <li class="context-line" id="context-50"><code>      @mapping.each do |host, location, match, app|</code></li>
              </ol>

              
              <ol start="61" class="post-context"
                  id="post-50" onclick="toggle(50);">
                
                <li class="post-context-line"><code>        unless casecmp?(http_host, host) \
</code></li>
                
                <li class="post-context-line"><code>            || casecmp?(server_name, host) \
</code></li>
                
                <li class="post-context-line"><code>            || (!host &amp;&amp; is_same_server) \
</code></li>
                
                <li class="post-context-line"><code>            || (!host &amp;&amp; !is_host_known) # If we don&#39;t have a matching host, default to the first without a specified host
</code></li>
                
                <li class="post-context-line"><code>          next
</code></li>
                
                <li class="post-context-line"><code>        end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-3.1.8/lib/rack/tempfile_reaper.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="13"
                  class="pre-context" id="pre-51"
                  onclick="toggle(51);">
                
                <li class="pre-context-line"><code>      @app = app
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    def call(env)
</code></li>
                
                <li class="pre-context-line"><code>      env[RACK_TEMPFILES] ||= []
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      begin
</code></li>
                
              </ol>
              

              <ol start="20" class="context" id="51"
                  onclick="toggle(51);">
                <li class="context-line" id="context-51"><code>        _, _, body = response = @app.call(env)</code></li>
              </ol>

              
              <ol start="21" class="post-context"
                  id="post-51" onclick="toggle(51);">
                
                <li class="post-context-line"><code>      rescue Exception
</code></li>
                
                <li class="post-context-line"><code>        env[RACK_TEMPFILES]&amp;.each(&amp;:close!)
</code></li>
                
                <li class="post-context-line"><code>        raise
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      response[2] = BodyProxy.new(body) do
</code></li>
                
                <li class="post-context-line"><code>        env[RACK_TEMPFILES]&amp;.each(&amp;:close!)
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-3.1.8/lib/rack/lint.rb</code> in
                <code><strong>response</strong></code>
            </li>

            <li class="code system">
              
              <ol start="59"
                  class="pre-context" id="pre-52"
                  onclick="toggle(52);">
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      def response
</code></li>
                
                <li class="pre-context-line"><code>        ## It takes exactly one argument, the *environment*
</code></li>
                
                <li class="pre-context-line"><code>        raise LintError, &quot;No env given&quot; unless @env
</code></li>
                
                <li class="pre-context-line"><code>        check_environment(@env)
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>        ## and returns a non-frozen Array of exactly three values:
</code></li>
                
              </ol>
              

              <ol start="66" class="context" id="52"
                  onclick="toggle(52);">
                <li class="context-line" id="context-52"><code>        @response = @app.call(@env)</code></li>
              </ol>

              
              <ol start="67" class="post-context"
                  id="post-52" onclick="toggle(52);">
                
                <li class="post-context-line"><code>        raise LintError, &quot;response is not an Array, but #{@response.class}&quot; unless @response.kind_of? Array
</code></li>
                
                <li class="post-context-line"><code>        raise LintError, &quot;response is frozen&quot; if @response.frozen?
</code></li>
                
                <li class="post-context-line"><code>        raise LintError, &quot;response array has #{@response.size} elements instead of 3&quot; unless @response.size == 3
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>        @status, @headers, @body = @response
</code></li>
                
                <li class="post-context-line"><code>        ## The *status*,
</code></li>
                
                <li class="post-context-line"><code>        check_status(@status)
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-3.1.8/lib/rack/lint.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="34"
                  class="pre-context" id="pre-53"
                  onclick="toggle(53);">
                
                <li class="pre-context-line"><code>    ## after to catch all mistakes.
</code></li>
                
                <li class="pre-context-line"><code>    ##
</code></li>
                
                <li class="pre-context-line"><code>    ## = Rack applications
</code></li>
                
                <li class="pre-context-line"><code>    ##
</code></li>
                
                <li class="pre-context-line"><code>    ## A Rack application is a Ruby object (not a class) that
</code></li>
                
                <li class="pre-context-line"><code>    ## responds to +call+.
</code></li>
                
                <li class="pre-context-line"><code>    def call(env = nil)
</code></li>
                
              </ol>
              

              <ol start="41" class="context" id="53"
                  onclick="toggle(53);">
                <li class="context-line" id="context-53"><code>      Wrapper.new(@app, env).response</code></li>
              </ol>

              
              <ol start="42" class="post-context"
                  id="post-53" onclick="toggle(53);">
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>    class Wrapper
</code></li>
                
                <li class="post-context-line"><code>      def initialize(app, env)
</code></li>
                
                <li class="post-context-line"><code>        @app = app
</code></li>
                
                <li class="post-context-line"><code>        @env = env
</code></li>
                
                <li class="post-context-line"><code>        @response = nil
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-3.1.8/lib/rack/show_exceptions.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="24"
                  class="pre-context" id="pre-54"
                  onclick="toggle(54);">
                
                <li class="pre-context-line"><code>                       :post_context)
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    def initialize(app)
</code></li>
                
                <li class="pre-context-line"><code>      @app = app
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    def call(env)
</code></li>
                
              </ol>
              

              <ol start="31" class="context" id="54"
                  onclick="toggle(54);">
                <li class="context-line" id="context-54"><code>      @app.call(env)</code></li>
              </ol>

              
              <ol start="32" class="post-context"
                  id="post-54" onclick="toggle(54);">
                
                <li class="post-context-line"><code>    rescue StandardError, LoadError, SyntaxError =&gt; e
</code></li>
                
                <li class="post-context-line"><code>      exception_string = dump_exception(e)
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      env[RACK_ERRORS].puts(exception_string)
</code></li>
                
                <li class="post-context-line"><code>      env[RACK_ERRORS].flush
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      if accepts_html?(env)
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/rack-3.1.8/lib/rack/content_length.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="13"
                  class="pre-context" id="pre-55"
                  onclick="toggle(55);">
                
                <li class="pre-context-line"><code>    include Rack::Utils
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    def initialize(app)
</code></li>
                
                <li class="pre-context-line"><code>      @app = app
</code></li>
                
                <li class="pre-context-line"><code>    end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>    def call(env)
</code></li>
                
              </ol>
              

              <ol start="20" class="context" id="55"
                  onclick="toggle(55);">
                <li class="context-line" id="context-55"><code>      status, headers, body = response = @app.call(env)</code></li>
              </ol>

              
              <ol start="21" class="post-context"
                  id="post-55" onclick="toggle(55);">
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      if !STATUS_WITH_NO_ENTITY_BODY.key?(status.to_i) &amp;&amp;
</code></li>
                
                <li class="post-context-line"><code>         !headers[CONTENT_LENGTH] &amp;&amp;
</code></li>
                
                <li class="post-context-line"><code>         !headers[TRANSFER_ENCODING] &amp;&amp;
</code></li>
                
                <li class="post-context-line"><code>         body.respond_to?(:to_ary)
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>        response[2] = body = body.to_ary
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/puma-6.4.3/lib/puma/configuration.rb</code> in
                <code><strong>call</strong></code>
            </li>

            <li class="code system">
              
              <ol start="265"
                  class="pre-context" id="pre-56"
                  onclick="toggle(56);">
                
                <li class="pre-context-line"><code>      def initialize(config, app)
</code></li>
                
                <li class="pre-context-line"><code>        @config = config
</code></li>
                
                <li class="pre-context-line"><code>        @app = app
</code></li>
                
                <li class="pre-context-line"><code>      end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      def call(env)
</code></li>
                
                <li class="pre-context-line"><code>        env[Const::PUMA_CONFIG] = @config
</code></li>
                
              </ol>
              

              <ol start="272" class="context" id="56"
                  onclick="toggle(56);">
                <li class="context-line" id="context-56"><code>        @app.call(env)</code></li>
              </ol>

              
              <ol start="273" class="post-context"
                  id="post-56" onclick="toggle(56);">
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>    # Indicate if there is a properly configured app
</code></li>
                
                <li class="post-context-line"><code>    #
</code></li>
                
                <li class="post-context-line"><code>    def app_configured?
</code></li>
                
                <li class="post-context-line"><code>      @options[:app] || File.exist?(rackup)
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/puma-6.4.3/lib/puma/request.rb</code> in
                <code><strong>block in handle_request</strong></code>
            </li>

            <li class="code system">
              
              <ol start="93"
                  class="pre-context" id="pre-57"
                  onclick="toggle(57);">
                
                <li class="pre-context-line"><code>      # array, we will invoke them when the request is done.
</code></li>
                
                <li class="pre-context-line"><code>      #
</code></li>
                
                <li class="pre-context-line"><code>      env[RACK_AFTER_REPLY] ||= []
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      begin
</code></li>
                
                <li class="pre-context-line"><code>        if @supported_http_methods == :any || @supported_http_methods.key?(env[REQUEST_METHOD])
</code></li>
                
                <li class="pre-context-line"><code>          status, headers, app_body = @thread_pool.with_force_shutdown do
</code></li>
                
              </ol>
              

              <ol start="100" class="context" id="57"
                  onclick="toggle(57);">
                <li class="context-line" id="context-57"><code>            @app.call(env)</code></li>
              </ol>

              
              <ol start="101" class="post-context"
                  id="post-57" onclick="toggle(57);">
                
                <li class="post-context-line"><code>          end
</code></li>
                
                <li class="post-context-line"><code>        else
</code></li>
                
                <li class="post-context-line"><code>          @log_writer.log &quot;Unsupported HTTP method used: #{env[REQUEST_METHOD]}&quot;
</code></li>
                
                <li class="post-context-line"><code>          status, headers, app_body = [501, {}, [&quot;#{env[REQUEST_METHOD]} method is not supported&quot;]]
</code></li>
                
                <li class="post-context-line"><code>        end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>        # app_body needs to always be closed, hold value in case lowlevel_error
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/puma-6.4.3/lib/puma/thread_pool.rb</code> in
                <code><strong>with_force_shutdown</strong></code>
            </li>

            <li class="code system">
              
              <ol start="371"
                  class="pre-context" id="pre-58"
                  onclick="toggle(58);">
                
                <li class="pre-context-line"><code>    # provided block if the thread is forced to shutdown during execution.
</code></li>
                
                <li class="pre-context-line"><code>    def with_force_shutdown
</code></li>
                
                <li class="pre-context-line"><code>      t = Thread.current
</code></li>
                
                <li class="pre-context-line"><code>      @shutdown_mutex.synchronize do
</code></li>
                
                <li class="pre-context-line"><code>        raise ForceShutdown if @force_shutdown
</code></li>
                
                <li class="pre-context-line"><code>        t[:with_force_shutdown] = true
</code></li>
                
                <li class="pre-context-line"><code>      end
</code></li>
                
              </ol>
              

              <ol start="378" class="context" id="58"
                  onclick="toggle(58);">
                <li class="context-line" id="context-58"><code>      yield</code></li>
              </ol>

              
              <ol start="379" class="post-context"
                  id="post-58" onclick="toggle(58);">
                
                <li class="post-context-line"><code>    ensure
</code></li>
                
                <li class="post-context-line"><code>      t[:with_force_shutdown] = false
</code></li>
                
                <li class="post-context-line"><code>    end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>    # Tell all threads in the pool to exit and wait for them to finish.
</code></li>
                
                <li class="post-context-line"><code>    # Wait +timeout+ seconds then raise +ForceShutdown+ in remaining threads.
</code></li>
                
                <li class="post-context-line"><code>    # Next, wait an extra +@shutdown_grace_time+ seconds then force-kill remaining
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/puma-6.4.3/lib/puma/request.rb</code> in
                <code><strong>handle_request</strong></code>
            </li>

            <li class="code system">
              
              <ol start="92"
                  class="pre-context" id="pre-59"
                  onclick="toggle(59);">
                
                <li class="pre-context-line"><code>      # A rack extension. If the app writes #call&#39;ables to this
</code></li>
                
                <li class="pre-context-line"><code>      # array, we will invoke them when the request is done.
</code></li>
                
                <li class="pre-context-line"><code>      #
</code></li>
                
                <li class="pre-context-line"><code>      env[RACK_AFTER_REPLY] ||= []
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      begin
</code></li>
                
                <li class="pre-context-line"><code>        if @supported_http_methods == :any || @supported_http_methods.key?(env[REQUEST_METHOD])
</code></li>
                
              </ol>
              

              <ol start="99" class="context" id="59"
                  onclick="toggle(59);">
                <li class="context-line" id="context-59"><code>          status, headers, app_body = @thread_pool.with_force_shutdown do</code></li>
              </ol>

              
              <ol start="100" class="post-context"
                  id="post-59" onclick="toggle(59);">
                
                <li class="post-context-line"><code>            @app.call(env)
</code></li>
                
                <li class="post-context-line"><code>          end
</code></li>
                
                <li class="post-context-line"><code>        else
</code></li>
                
                <li class="post-context-line"><code>          @log_writer.log &quot;Unsupported HTTP method used: #{env[REQUEST_METHOD]}&quot;
</code></li>
                
                <li class="post-context-line"><code>          status, headers, app_body = [501, {}, [&quot;#{env[REQUEST_METHOD]} method is not supported&quot;]]
</code></li>
                
                <li class="post-context-line"><code>        end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/puma-6.4.3/lib/puma/server.rb</code> in
                <code><strong>process_client</strong></code>
            </li>

            <li class="code system">
              
              <ol start="457"
                  class="pre-context" id="pre-60"
                  onclick="toggle(60);">
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>        with_force_shutdown(client) do
</code></li>
                
                <li class="pre-context-line"><code>          client.finish(@first_data_timeout)
</code></li>
                
                <li class="pre-context-line"><code>        end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>        while true
</code></li>
                
                <li class="pre-context-line"><code>          @requests_count += 1
</code></li>
                
              </ol>
              

              <ol start="464" class="context" id="60"
                  onclick="toggle(60);">
                <li class="context-line" id="context-60"><code>          case handle_request(client, requests + 1)</code></li>
              </ol>

              
              <ol start="465" class="post-context"
                  id="post-60" onclick="toggle(60);">
                
                <li class="post-context-line"><code>          when false
</code></li>
                
                <li class="post-context-line"><code>            break
</code></li>
                
                <li class="post-context-line"><code>          when :async
</code></li>
                
                <li class="post-context-line"><code>            close_socket = false
</code></li>
                
                <li class="post-context-line"><code>            break
</code></li>
                
                <li class="post-context-line"><code>          when true
</code></li>
                
                <li class="post-context-line"><code>            ThreadPool.clean_thread_locals if clean_thread_locals
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/puma-6.4.3/lib/puma/server.rb</code> in
                <code><strong>block in run</strong></code>
            </li>

            <li class="code system">
              
              <ol start="238"
                  class="pre-context" id="pre-61"
                  onclick="toggle(61);">
                
                <li class="pre-context-line"><code>    def run(background=true, thread_name: &#39;srv&#39;)
</code></li>
                
                <li class="pre-context-line"><code>      BasicSocket.do_not_reverse_lookup = true
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      @events.fire :state, :booting
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>      @status = :run
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
              </ol>
              

              <ol start="245" class="context" id="61"
                  onclick="toggle(61);">
                <li class="context-line" id="context-61"><code>      @thread_pool = ThreadPool.new(thread_name, @options) { |client| process_client client }</code></li>
              </ol>

              
              <ol start="246" class="post-context"
                  id="post-61" onclick="toggle(61);">
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      if @queue_requests
</code></li>
                
                <li class="post-context-line"><code>        @reactor = Reactor.new(@io_selector_backend) { |c| reactor_wakeup c }
</code></li>
                
                <li class="post-context-line"><code>        @reactor.run
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      
          

            <li class="frame-info system">
              <code>/usr/lib/ruby/gems/3.2.0/gems/puma-6.4.3/lib/puma/thread_pool.rb</code> in
                <code><strong>block in spawn_thread</strong></code>
            </li>

            <li class="code system">
              
              <ol start="148"
                  class="pre-context" id="pre-62"
                  onclick="toggle(62);">
                
                <li class="pre-context-line"><code>          end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>          if @clean_thread_locals
</code></li>
                
                <li class="pre-context-line"><code>            ThreadPool.clean_thread_locals
</code></li>
                
                <li class="pre-context-line"><code>          end
</code></li>
                
                <li class="pre-context-line"><code>
</code></li>
                
                <li class="pre-context-line"><code>          begin
</code></li>
                
              </ol>
              

              <ol start="155" class="context" id="62"
                  onclick="toggle(62);">
                <li class="context-line" id="context-62"><code>            @out_of_band_pending = true if block.call(work)</code></li>
              </ol>

              
              <ol start="156" class="post-context"
                  id="post-62" onclick="toggle(62);">
                
                <li class="post-context-line"><code>          rescue Exception =&gt; e
</code></li>
                
                <li class="post-context-line"><code>            STDERR.puts &quot;Error reached top of thread-pool: #{e.message} (#{e.class})&quot;
</code></li>
                
                <li class="post-context-line"><code>          end
</code></li>
                
                <li class="post-context-line"><code>        end
</code></li>
                
                <li class="post-context-line"><code>      end
</code></li>
                
                <li class="post-context-line"><code>
</code></li>
                
                <li class="post-context-line"><code>      @workers &lt;&lt; th
</code></li>
                
              </ol>
              
              <div class="clear"></div>
            </li>

          

        
      

      </ul>
    </div> <!-- /BACKTRACE -->

    
      <div id="get">
        <h3 id="get-info">GET</h3>
        
          <table class="req">
            <tr>
              <th>Variable</th>
              <th>Value</th>
            </tr>
             
            <tr>
              <td>iPad</td>
              <td class="code"><div>&quot;1&quot;</div></td>
            </tr>
            
            <tr>
              <td>static</td>
              <td class="code"><div>&quot;1&quot;</div></td>
            </tr>
            
          </table>
        
        <div class="clear"></div>
      </div> <!-- /GET -->

      <div id="post">
        <h3 id="post-info">POST</h3>
        
          <p class="no-data">No POST data.</p>
        
        <div class="clear"></div>
      </div> <!-- /POST -->
    

    <div id="cookies">
      <h3 id="cookie-info">COOKIES</h3>
      
        <p class="no-data">No cookie data.</p>
      
      <div class="clear"></div>
    </div> <!-- /COOKIES -->

    <div id="rack">
      <h3 id="env-info">Rack ENV</h3>
      <table class="req">
        <tr>
          <th>Variable</th>
          <th>Value</th>
        </tr>
         
         <tr>
           <td>GATEWAY_INTERFACE</td>
           <td class="code"><div>CGI/1.2</div></td>
         </tr>
         
         <tr>
           <td>HTTP_ACCEPT_ENCODING</td>
           <td class="code"><div>gzip</div></td>
         </tr>
         
         <tr>
           <td>HTTP_HOST</td>
           <td class="code"><div>localhost:4570</div></td>
         </tr>
         
         <tr>
           <td>HTTP_USER_AGENT</td>
           <td class="code"><div>Go-http-client/1.1</div></td>
         </tr>
         
         <tr>
           <td>HTTP_VERSION</td>
           <td class="code"><div>HTTP/1.1</div></td>
         </tr>
         
         <tr>
           <td>PATH_INFO</td>
           <td class="code"><div>/list/2024-03-TH</div></td>
         </tr>
         
         <tr>
           <td>QUERY_STRING</td>
           <td class="code"><div>static=1&amp;iPad=1</div></td>
         </tr>
         
         <tr>
           <td>REMOTE_ADDR</td>
           <td class="code"><div>127.0.0.1</div></td>
         </tr>
         
         <tr>
           <td>REQUEST_METHOD</td>
           <td class="code"><div>GET</div></td>
         </tr>
         
         <tr>
           <td>REQUEST_PATH</td>
           <td class="code"><div>/playlist/list/2024-03-TH</div></td>
         </tr>
         
         <tr>
           <td>REQUEST_URI</td>
           <td class="code"><div>/playlist/list/2024-03-TH?static=1&amp;iPad=1</div></td>
         </tr>
         
         <tr>
           <td>SCRIPT_NAME</td>
           <td class="code"><div>/playlist</div></td>
         </tr>
         
         <tr>
           <td>SERVER_NAME</td>
           <td class="code"><div>localhost</div></td>
         </tr>
         
         <tr>
           <td>SERVER_PORT</td>
           <td class="code"><div>4570</div></td>
         </tr>
         
         <tr>
           <td>SERVER_PROTOCOL</td>
           <td class="code"><div>HTTP/1.1</div></td>
         </tr>
         
         <tr>
           <td>SERVER_SOFTWARE</td>
           <td class="code"><div>puma 6.4.3 The Eagle of Durango</div></td>
         </tr>
         
         <tr>
           <td>puma.config</td>
           <td class="code"><div>#&lt;Puma::Configuration:0x00007fd72a8b1010 @options=#&lt;Puma::UserFileDefaultOptions:0x00007fd7295488e8 @user_options={:environment=&gt;&quot;development&quot;, :pid=&gt;nil, :Port=&gt;&quot;4570&quot;, :Host=&gt;&quot;0.0.0.0&quot;, :AccessLog=&gt;[], :config=&gt;&quot;/app/config.ru&quot;, :quiet=&gt;true, :binds=&gt;[&quot;tcp://0.0.0.0:4570&quot;], :app=&gt;#&lt;Rack::ContentLength:0x00007fd72b653128 @app=#&lt;Rack::ShowExceptions:0x00007fd72aafab78 @app=#&lt;Rack::Lint:0x00007fd72aaa0628 @app=#&lt;Rack::TempfileReaper:0x00007fd72aaa1500 @app=#&lt;Rack::URLMap:0x00007fd72aa30760 @known_hosts=#&lt;Set: {}&gt;, @mapping=[[nil, &quot;/playlist&quot;, /^\/+playlist(.*)/n, #&lt;PlaylistPortal app_file=&quot;/app/controllers/my_portal.rb&quot;&gt;], [nil, &quot;/images&quot;, /^\/+images(.*)/n, #&lt;Proc:0x00007fd728fe1a08 /app/config.ru:13 (lambda)&gt;], [nil, &quot;/smule&quot;, /^\/+smule(.*)/n, #&lt;SmulePortal app_file=&quot;/app/controllers/my_portal.rb&quot;&gt;], [nil, &quot;/js&quot;, /^\/+js(.*)/n, #&lt;Proc:0x00007fd728fe1a30 /app/config.ru:10 (lambda)&gt;]]&gt;&gt;&gt;&gt;&gt;, :log_writer=&gt;#&lt;Puma::LogWriter:0x00007fd72a8b0fc0 @formatter=#&lt;Puma::LogWriter::DefaultFormatter:0x00007fd7295473a8&gt;, @custom_logger=nil, @stdout=#&lt;IO:&lt;STDOUT&gt;&gt;, @stderr=#&lt;IO:&lt;STDERR&gt;&gt;, @debug=false, @error_logger=#&lt;Puma::ErrorLogger:0x00007fd729547380 @ioerr=#&lt;IO:&lt;STDERR&gt;&gt;, @debug=false&gt;&gt;}, @file_options={}, @default_options={:auto_trim_time=&gt;30, :binds=&gt;[&quot;tcp://0.0.0.0:9292&quot;], :clean_thread_locals=&gt;false, :debug=&gt;false, :early_hints=&gt;nil, :environment=&gt;&quot;development&quot;, :first_data_timeout=&gt;30, :idle_timeout=&gt;nil, :io_selector_backend=&gt;:auto, :log_requests=&gt;false, :logger=&gt;#&lt;IO:&lt;STDOUT&gt;&gt;, :max_fast_inline=&gt;10, :max_threads=&gt;5, :min_threads=&gt;0, :mode=&gt;:http, :mutate_stdout_and_stderr_to_sync_on_write=&gt;true, :out_of_band=&gt;[], :persistent_timeout=&gt;20, :queue_requests=&gt;true, :rackup=&gt;&quot;config.ru&quot;, :raise_exception_on_sigterm=&gt;true, :reaping_time=&gt;1, :remote_address=&gt;:socket, :silence_single_worker_warning=&gt;false, :silence_fork_callback_warning=&gt;false, :tag=&gt;&quot;app&quot;, :tcp_host=&gt;&quot;0.0.0.0&quot;, :tcp_port=&gt;9292, :wait_for_less_busy_worker=&gt;0.005, :worker_boot_timeout=&gt;60, :worker_check_interval=&gt;5, :worker_culling_strategy=&gt;:youngest, :worker_shutdown_timeout=&gt;30, :worker_timeout=&gt;60, :workers=&gt;0, :http_content_length_limit=&gt;nil, :Verbose=&gt;false, :Silent=&gt;false, :events=&gt;#&lt;Puma::Events:0x00007fd729548d70 @hooks={:state=&gt;[], :on_booted=&gt;[]}&gt;, :preload_app=&gt;false}&gt;, @plugins=#&lt;Puma::PluginLoader:0x00007fd729548780 @instances=[]&gt;, @user_dsl=#&lt;Puma::DSL:0x00007fd729548500 @config=#&lt;Puma::Configuration:0x00007fd72a8b1010 ...&gt;, @options={:environment=&gt;&quot;development&quot;, :pid=&gt;nil, :Port=&gt;&quot;4570&quot;, :Host=&gt;&quot;0.0.0.0&quot;, :AccessLog=&gt;[], :config=&gt;&quot;/app/config.ru&quot;, :quiet=&gt;true, :binds=&gt;[&quot;tcp://0.0.0.0:4570&quot;], :app=&gt;#&lt;Rack::ContentLength:0x00007fd72b653128 @app=#&lt;Rack::ShowExceptions:0x00007fd72aafab78 @app=#&lt;Rack::Lint:0x00007fd72aaa0628 @app=#&lt;Rack::TempfileReaper:0x00007fd72aaa1500 @app=#&lt;Rack::URLMap:0x00007fd72aa30760 @known_hosts=#&lt;Set: {}&gt;, @mapping=[[nil, &quot;/playlist&quot;, /^\/+playlist(.*)/n, #&lt;PlaylistPortal app_file=&quot;/app/controllers/my_portal.rb&quot;&gt;], [nil, &quot;/images&quot;, /^\/+images(.*)/n, #&lt;Proc:0x00007fd728fe1a08 /app/config.ru:13 (lambda)&gt;], [nil, &quot;/smule&quot;, /^\/+smule(.*)/n, #&lt;SmulePortal app_file=&quot;/app/controllers/my_portal.rb&quot;&gt;], [nil, &quot;/js&quot;, /^\/+js(.*)/n, #&lt;Proc:0x00007fd728fe1a30 /app/config.ru:10 (lambda)&gt;]]&gt;&gt;&gt;&gt;&gt;, :log_writer=&gt;#&lt;Puma::LogWriter:0x00007fd72a8b0fc0 @formatter=#&lt;Puma::LogWriter::DefaultFormatter:0x00007fd7295473a8&gt;, @custom_logger=nil, @stdout=#&lt;IO:&lt;STDOUT&gt;&gt;, @stderr=#&lt;IO:&lt;STDERR&gt;&gt;, @debug=false, @error_logger=#&lt;Puma::ErrorLogger:0x00007fd729547380 @ioerr=#&lt;IO:&lt;STDERR&gt;&gt;, @debug=false&gt;&gt;}, @plugins=[]&gt;, @file_dsl=#&lt;Puma::DSL:0x00007fd729548410 @config=#&lt;Puma::Configuration:0x00007fd72a8b1010 ...&gt;, @options={}, @plugins=[]&gt;, @default_dsl=#&lt;Puma::DSL:0x00007fd729548320 @config=#&lt;Puma::Configuration:0x00007fd72a8b1010 ...&gt;, @options={:auto_trim_time=&gt;30, :binds=&gt;[&quot;tcp://0.0.0.0:9292&quot;], :clean_thread_locals=&gt;false, :debug=&gt;false, :early_hints=&gt;nil, :environment=&gt;&quot;development&quot;, :first_data_timeout=&gt;30, :idle_timeout=&gt;nil, :io_selector_backend=&gt;:auto, :log_requests=&gt;false, :logger=&gt;#&lt;IO:&lt;STDOUT&gt;&gt;, :max_fast_inline=&gt;10, :max_threads=&gt;5, :min_threads=&gt;0, :mode=&gt;:http, :mutate_stdout_and_stderr_to_sync_on_write=&gt;true, :out_of_band=&gt;[], :persistent_timeout=&gt;20, :queue_requests=&gt;true, :rackup=&gt;&quot;config.ru&quot;, :raise_exception_on_sigterm=&gt;true, :reaping_time=&gt;1, :remote_address=&gt;:socket, :silence_single_worker_warning=&gt;false, :silence_fork_callback_warning=&gt;false, :tag=&gt;&quot;app&quot;, :tcp_host=&gt;&quot;0.0.0.0&quot;, :tcp_port=&gt;9292, :wait_for_less_busy_worker=&gt;0.005, :worker_boot_timeout=&gt;60, :worker_check_interval=&gt;5, :worker_culling_strategy=&gt;:youngest, :worker_shutdown_timeout=&gt;30, :worker_timeout=&gt;60, :workers=&gt;0, :http_content_length_limit=&gt;nil, :Verbose=&gt;false, :Silent=&gt;false, :events=&gt;#&lt;Puma::Events:0x00007fd729548d70 @hooks={:state=&gt;[], :on_booted=&gt;[]}&gt;, :preload_app=&gt;false}, @plugins=[]&gt;&gt;</div></td>
         </tr>
         
         <tr>
           <td>puma.request_body_wait</td>
           <td class="code"><div>0.0036770030856132507</div></td>
         </tr>
         
         <tr>
           <td>puma.socket</td>
           <td class="code"><div>#&lt;TCPSocket:fd 13, AF_INET, 127.0.0.1, 4570&gt;</div></td>
         </tr>
         
         <tr>
           <td>rack.after_reply</td>
           <td class="code"><div>[]</div></td>
         </tr>
         
         <tr>
           <td>rack.errors</td>
           <td class="code"><div>#&lt;Object:0x00007fd72b7d9bf0&gt;</div></td>
         </tr>
         
         <tr>
           <td>rack.hijack</td>
           <td class="code"><div>#&lt;Proc:0x00007fd727a7a728 /usr/lib/ruby/gems/3.2.0/gems/rack-3.1.8/lib/rack/lint.rb:596&gt;</div></td>
         </tr>
         
         <tr>
           <td>rack.hijack?</td>
           <td class="code"><div>true</div></td>
         </tr>
         
         <tr>
           <td>rack.input</td>
           <td class="code"><div>#&lt;Rack::Lint::Wrapper::InputWrapper:0x00007fd727a7a868 @input=#&lt;Puma::NullIO:0x00007fd729680878&gt;&gt;</div></td>
         </tr>
         
         <tr>
           <td>rack.logger</td>
           <td class="code"><div>#&lt;Rack::NullLogger:0x00007fd72aa32a60 @app=#&lt;Rack::Session::Cookie:0x00007fd72b61ca88 @encryptors=[#&lt;Rack::Session::Encryptor:0x00007fd72aa35648 @options={:serialize_json=&gt;nil, :pad_size=&gt;32, :purpose=&gt;nil}, @hmac_secret=&quot;015b3686226470dac758b6cc57cc5dd6a17172d9fed0ea63f5e3ad7632ed9327213aea56426429f2fd9bd802a04e43b4&quot;, @cipher_secret=&quot;f54d0a65ee092cad072bee4020db9684&quot;, @serializer=Marshal&gt;], @legacy_hmac=&quot;SHA1&quot;, @legacy_hmac_secret=&quot;f54d0a65ee092cad072bee4020db9684015b3686226470dac758b6cc57cc5dd6a17172d9fed0ea63f5e3ad7632ed9327213aea56426429f2fd9bd802a04e43b4&quot;, @legacy_hmac_coder=#&lt;Rack::Session::Cookie::Base64::Marshal:0x00007fd72aa33820&gt;, @coder=#&lt;Rack::Session::Cookie::Base64::Marshal:0x00007fd72aa337d0&gt;, @app=#&lt;Rack::Protection::FrameOptions:0x00007fd72aa37218 @app=#&lt;Rack::Protection::HttpOrigin:0x00007fd72aa388e8 @app=#&lt;Rack::Protection::IPSpoofing:0x00007fd72aa390e0 @app=#&lt;Rack::Protection::JsonCsrf:0x00007fd72aa3a878 @app=#&lt;Rack::Protection::PathTraversal:0x00007fd72aa3ba48 @app=#&lt;Rack::Protection::RemoteToken:0x00007fd72aa3c8d0 @app=#&lt;Rack::Protection::XSSHeader:0x00007fd72aa3e130 @app=#&lt;PlaylistPortal:0x00007fd72a95f340 @current_engine=:ruby, @default_layout=:layout, @preferred_extension=nil, @app=nil, @template_cache=#&lt;Sinatra::TemplateCache:0x00007fd72a95e0d0 @cache={[:slim, :program, {:outvar=&gt;&quot;@_out_buf&quot;, :default_encoding=&gt;&quot;utf-8&quot;}, &quot;/app/controllers/../views&quot;]=&gt;#&lt;Slim::Template:0x00007fd729bc4118 @options={:outvar=&gt;&quot;@_out_buf&quot;}, @line=1, @file=&quot;/app/controllers/../views/program.slim&quot;, @compiled_method={[PlaylistPortal, [:content, :extra, :playlists, :program, :title, :type]]=&gt;#&lt;UnboundMethod: Tilt::CompiledTemplates#__tilt_685680(locals) /app/controllers/../views/program.slim:-7&gt;}, @default_encoding=&quot;utf-8&quot;, @skip_compiled_encoding_detection=nil, @data=&quot;/! ============================================================ \n/! Generates program / practice content page\n/! ============================================================ \n\n- content_for :css do\n  css:\n    .lsource {\n      text-decoration: underline;\n    }\n    .chorder {\n      margin-right: 10px;\n    }\n    .loopstyle {\n      font-size: 70%;\n    }\n    .transpose {\n      font-size:        90%;\n      background-color: #ccc;\n      padding-left:     4px;\n      padding-right:    4px;\n    }\n    #list-select {\n      position: absolute;\n      top:      10px;\n      right:    10px;\n      width:    150px;\n    }\n    #youtube {\n      border:   1px solid #222;\n      display:  none;\n      z-index:  9999;\n      position: fixed;\n      top:      0;\n      left:     0;\n      width:    350px;\n      height:   200px;\n    }\n    #youtube iframe {\n      position: absolute;\n      top:      0;\n      left:     0;\n      width:    100%;\n      height:   100%;\n    }\n    .hidden {\n      color:     #fff;\n      font-size: 10%;\n    }\n    .qrcode svg {\n    }\n    th.hiddenCol, td.hiddenCol {\n      display: none\n    }\n\n- if test(?f, \&quot;images/\#{program}.jpg\&quot;)\n  - content_for :css do\n    css:\n      .program-info {\n        background-image: linear-gradient(rgba(255, 255, 255, 0.75), rgba(255, 255, 255, 0.75)), url(\&quot;/images/\#{program}.jpg\&quot;);\n        background-size: auto;\n        background-position: center; /* Centers the image */\n        background-repeat: repeat; /* Prevents the image from repeating */\n      }\n\n/! Select different playlist\n- ltype = params[:type] || content[:type] || &#39;list&#39;\n\n/! Video player - hidden until brought up\n- locals = {id: &#39;youtube&#39;, width:250, height: 140}\n== partial :_pl_player, locals: locals, template_engine: :slim\n\n/! Allow language accent, etc \n- locals = {id: &#39;lybox&#39;, ltype: ltype}\n== partial :_lyric_box, locals: locals, template_engine: :slim\n\n.row.program-info\n  .col-md-8\n    h1\n      = content[:title]\n    h5\n      a href=content[:source] target=&#39;sheet&#39;\n        = \&quot;\#{content[:location]}  - \#{content[:date]}\&quot;\n    - if content[:links]\n      .mark.small\n        - content[:links].each do |name, value|\n          a href=value target=name =name.capitalize\n  .col-md-4\n    select.form-select#list-select onchange=\&quot;window.location.href = &#39;../\#{ltype}/&#39; + this.options[this.selectedIndex].value\&quot;\n      - playlists.each do |item|\n        option value=item selected=(item == program) = item\n\n.row\n  .col-lg-12\n\n    - ismobile = (params[:static] != nil)\n    table.cell-border.compact.display.dt-responsive#main_table width=\&quot;100%\&quot;\n      thead\n        tr\n          th \n          th Key\n          th Title\n          th= ltype == \&quot;list\&quot; ? \&quot;Singer [Backing]\&quot; : \&quot;List\&quot;\n          th Beat [Tempo]\n          th Perf Video/Loops\n          th Note\n          th.hiddenCol S-Title\n      tbody\n        - async = params[:static] ? &#39;false&#39; : &#39;true&#39;\n        - content[:__list].each_with_index do |e, index|\n          - row_id = \&quot;row_\#{index}\&quot;\n          tr id=row_id\n            - perf_url = e[:perf_url] || &#39;&#39;\n            - yt_video = nil\n            - tempo = e[:perf_tempo] || e[:tempo]\n            td= index+2\n            td\n              .d-grid.gap-2\n                - if !e[:lyric].empty?\n                  - color = tempo_color(tempo)\n                  a.btn.btn-sm.btn-outline-secondary.chorder.mtooltip style=\&quot;background-color:\#{color}\&quot; onClick=\&quot;get_lyric(&#39;\#{program}&#39;, &#39;\#{row_id}&#39;, \#{async})\&quot; title=\&quot;Lyric for: \#{e[:title]}, tempo: \#{tempo}\&quot;\n                    b= (e[:key] &amp;&amp; !e[:key].empty?) ? e[:key] : &#39;?&#39;\n                    - if e[:transpose]\n                      span.transpose title=\&quot;Transpose\&quot; = e[:transpose]\n                    span.= e[:lead] ? \&quot; (\#{e[:lead]})\&quot; : \&quot;\&quot;\n                - else\n                  = (e[:key] &amp;&amp; !e[:key].empty?) ? e[:key] : &#39;?&#39;\n                  - if e[:transpose]\n                    span.transpose title=\&quot;Transpose\&quot; = e[:transpose]\n            td\n              - if params[:static]\n                a.msource href=&#39;#&#39; onClick=\&quot;get_lyric(&#39;\#{program}&#39;, &#39;\#{row_id}&#39;, \#{async})\&quot; title=\&quot;Lyric for: \#{e[:title]}, tempo: \#{tempo}\&quot;\n                  = e[:continue] ? \&quot;++\&quot; : \&quot;\&quot;\n                  = e[:title]\n              - else\n                a href=\&quot;../slyric/\#{program}/\#{row_id}\&quot;\n                  = e[:continue] ? \&quot;++\&quot; : \&quot;\&quot;\n                  = e[:title]\n              - if e[:note] &amp;&amp; !(@isIPhone || @isIPad)\n                = \&quot; (\#{e[:note][0..9]})\&quot;\n              - if e[:has_style]\n                | &amp;nbsp;\n                i.fa.fa-guitar\n            td\n              - if ltype == \&quot;list\&quot;\n                - unless (singer = capwords(to_stitle(e[:singer]))).empty?\n                  button.btn onClick=\&quot;return dt_search(&#39;\#{singer}&#39;)\&quot; \n                    = \&quot;\#{singer}\&quot; + (e[:backing] ? \&quot; [\#{e[:backing]}]\&quot; : \&quot;\&quot;)\n                  - if !(@isIPad || @isIPhone)\n                    a.chord href=\&quot;../singer/\#{singer.downcase}\&quot;\n                      i.fa.fa-user\n              - else\n                - unless (list = e[:singer]).empty?\n                  button.btn onClick=\&quot;return dt_search(&#39;\#{singer}&#39;)\&quot; = list\n                  a.chord href=\&quot;../list/\#{list}\&quot;\n                    i.fa.fa-list\n            td.dt-right\n              button.btn onClick=\&quot;return dt_search(&#39;\#{e[:beat]}&#39;)\&quot; = e[:beat]\n              - if tempo &amp;&amp; !(@iPhone || @iPad)\n                span.transpose.text-right title=\&quot;Tempo\&quot;= tempo\n            td\n              - perf_url = e[:perf_url] || &#39;&#39;\n              - if (yt_video = extract_yt_video(perf_url))\n                - title = e[:title].gsub(/&#39;/, &#39;&#39;)\n                button.btn.btn-sm.mtooltip title=\&quot;Play \#{yt_video}\&quot; onClick=\&quot;return play_on_youtube(&#39;\#{yt_video}&#39;, &#39;\#{title}&#39;, 0, 0)\&quot;\n                  i.fa-solid.fa-video\n                - (e[:perf_loop] || []).each do |els|\n                    - el = els.split(\&quot;-\&quot;).map{|f| f.to_i}\n                    button.btn.btn-sm.mtooltip onClick=\&quot;return play_on_youtube(&#39;\#{yt_video}&#39;, &#39;\#{title}&#39;, \#{el[0]}, \#{el[1]})\&quot; title=\&quot;Play loops\&quot;\n                      i.fa-solid.fa-undo\n                      div.loopstyle= \&quot;\#{el[0]}.\#{el[1]-el[0]}\&quot;\n              - elsif perf_url.start_with?(&#39;https://&#39;)\n                a href=perf_url target=&#39;Listen (not embed)&#39; Link\n              - else\n                = perf_url\n            td= e[:note] || e[:perf_note]\n            td.hiddenCol\n              = e[:stitle]\n\n    button.btn.btn-sm.btn-outline-secondary onClick=\&quot;reset_order()\&quot; Reset Order \n    - unless params[:static]\n      button.btn.btn-sm.btn-outline-secondary onClick=\&quot;sv_save_order()\&quot; Save to Server\n\n.qrcode== qrcode_for(request.url)\n\nscript\n  == \&quot;extra = \&quot; + extra.to_json\n\n- tname = File.basename(__FILE__)\n- content_for :javascript do\n  script src=\&quot;https://www.youtube.com/iframe_api\&quot;\n  javascript:\n\n    var main_table;\n    var myModal;\n\n    $(function() {\n\n      $(&#39;.mtooltip&#39;).tooltip()\n\n      main_table = new DataTable(&#39;#main_table&#39;, {\n        layout: {\n          topStart:    &#39;search&#39;,\n          bottomStart: &#39;info&#39;,\n        },\n        search: {\n          search: &#39;\#{params[:search]}&#39;,\n          caseInsensitive: true,\n        },\n        responsive: true,\n        paging:     false,\n        columns: [{data: &#39;id&#39;}, null, {data: &#39;title&#39;},\n                  null, null, null, null],\n        order:  [[ 0, \&quot;asc\&quot; ]],\n        columnDefs: [\n          { target: 1, visible: true,  searchable: false },\n          { target: 2, width: \&quot;40%\&quot; },\n          { target: 6, visible: false, searchable: true },\n          { target: 7, visible: false, searchable: true },\n        ],\n        rowReorder: {\n          dataSrc: &#39;id&#39;,\n        },\n        initComplete: function(settings, json) {\n          var newkey  = &#39;&#39;\n          for (let value of $(&#39;#main_table tbody tr&#39;)) {\n            newkey += value.childNodes[3].innerText.replace(/[\\(\\) ]/g, \&quot;\&quot;)\n          }\n          let curkey = localStorage.getItem(&#39;pagekey.\#{program}&#39;)\n          console.log(`\#{tname}:\#{__LINE__} \#{program} curkey: ${curkey}`)\n          console.log(`\#{tname}:\#{__LINE__} \#{program} newkey: ${newkey}`)\n          localStorage.setItem(\&quot;pagekey.\#{program}\&quot;, newkey)\n          if (curkey == newkey) {\n            restore_order()\n          }\n        }\n      });\n\n      main_table.on(&#39;row-reorder&#39;, (e, diff, edit) =&gt; {\n        setTimeout(() =&gt; { save_order() }, 100)\n      })\n\n      myModal  = new bootstrap.Modal(document.getElementById(&#39;lybox&#39;))\n    });\n\n    function reset_order() {\n      localStorage.removeItem(\&quot;pageorder.\#{program}\&quot;)\n      location.reload()\n    }\n\n    function current_order() {\n      var olist = []\n      for (value of $(&#39;#main_table tbody tr&#39;)) {\n        // console.log(&#39;rowid&#39;, value.id)\n        olist.push(value.id)\n      }\n      return olist\n    }\n\n    // Save order to localstore (per device only)\n    function save_order() {\n      var olist = current_order()\n      console.log(`\#{tname}:\#{__LINE__} new_list: ${olist}`)\n      localStorage.setItem(\&quot;pageorder.\#{program}\&quot;, JSON.stringify(olist))\n    }\n\n    // Save order to server (so it could be shared)\n    function sv_save_order() {\n      var olist = current_order()\n      var url = `../reorder/\#{program}/${olist.join(&#39;,&#39;)}`\n      jQuery.ajax({\n        url:      url,\n        method:   &#39;POST&#39;,\n        async:    false,\n        dataType: &#39;json&#39;,\n        success:  location.reload(),\n      });\n    }\n\n    function restore_order() {\n      let item = localStorage.getItem(\&quot;pageorder.\#{program}\&quot;)\n      if (item == null) {\n        console.log(`\#{tname}:\#{__LINE__} No order to restore`)\n        return\n      }\n\n      let olist   = JSON.parse(item)\n      let dt_rows = $(&#39;#main_table tbody tr&#39;)\n      var offset  = 2\n      console.log(`\#{tname}:\#{__LINE__} Restore olist: ${olist}`)\n\n      for (rowno of olist) {\n        // console.log(&#39;rowno: &#39;, rowno)\n        // console.log(&#39;dtrow: &#39;, dt_rows[rowno])\n\n        if (dt_rows[rowno] == null) {\n          continue\n        }\n        let listno = dt_rows[rowno].childNodes[2].innerText\n        dt_rows[rowno].childNodes[2].innerText = offset\n        offset += 1\n      }\n\n      setTimeout(() =&gt; {\n        main_table.rows().invalidate().draw()\n      }, 100)\n    }\n\n&quot;, @src=&quot;begin; _temple_generators_stringbuffer1 = @_out_buf if defined?(@_out_buf); @_out_buf = &#39;&#39;.dup; _temple_html_pretty1 = /&lt;code|&lt;pre|&lt;textarea/; @_out_buf &lt;&lt; (\&quot;&lt;!--============================================================ --&gt;&lt;!--Generates program / practice content page--&gt;&lt;!--============================================================ --&gt;\&quot;.freeze); \n; \n; \n; \n; content_for :css do; \n; @_out_buf &lt;&lt; (\&quot;\\n&lt;style&gt;\\n  .lsource {\\n    text-decoration: underline;\\n  }\\n  .chorder {\\n    margin-right: 10px;\\n  }\\n  .loopstyle {\\n    font-size: 70%;\\n  }\\n  .transpose {\\n    font-size:        90%;\\n    background-color: #ccc;\\n    padding-left:     4px;\\n    padding-right:    4px;\\n  }\\n  #list-select {\\n    position: absolute;\\n    top:      10px;\\n    right:    10px;\\n    width:    150px;\\n  }\\n  #youtube {\\n    border:   1px solid #222;\\n    display:  none;\\n    z-index:  9999;\\n    position: fixed;\\n    top:      0;\\n    left:     0;\\n    width:    350px;\\n    height:   200px;\\n  }\\n  #youtube iframe {\\n    position: absolute;\\n    top:      0;\\n    left:     0;\\n    width:    100%;\\n    height:   100%;\\n  }\\n  .hidden {\\n    color:     #fff;\\n    font-size: 10%;\\n  }\\n  .qrcode svg {\\n  }\\n  th.hiddenCol, td.hiddenCol {\\n    display: none\\n  }\\n&lt;/style&gt;\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; end; if test(?f, \&quot;images/\#{program}.jpg\&quot;); \n; content_for :css do; \n; @_out_buf &lt;&lt; (\&quot;\\n&lt;style&gt;\\n  .program-info {\\n    background-image: linear-gradient(rgba(255, 255, 255, 0.75), rgba(255, 255, 255, 0.75)), url(\\\&quot;/images/\&quot;.freeze); \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((program), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;.jpg\\\&quot;);\\n    background-size: auto;\\n    background-position: center; /* Centers the image */\\n    background-repeat: repeat; /* Prevents the image from repeating */\\n  }\\n&lt;/style&gt;\&quot;.freeze); \n; \n; \n; \n; \n; \n; end; end; @_out_buf &lt;&lt; (\&quot;\\n&lt;!--Select different playlist--&gt;\&quot;.freeze); \n; ltype = params[:type] || content[:type] || &#39;list&#39;; \n; \n; @_out_buf &lt;&lt; (\&quot;&lt;!--Video player - hidden until brought up--&gt;\&quot;.freeze); \n; locals = {id: &#39;youtube&#39;, width:250, height: 140}; \n; @_out_buf &lt;&lt; ((::Temple::Utils.indent_dynamic((partial :_pl_player, locals: locals, template_engine: :slim), false, \&quot;\\n\&quot;, _temple_html_pretty1)).to_s); \n; \n; @_out_buf &lt;&lt; (\&quot;&lt;!--Allow language accent, etc --&gt;\&quot;.freeze); \n; locals = {id: &#39;lybox&#39;, ltype: ltype}; \n; @_out_buf &lt;&lt; ((::Temple::Utils.indent_dynamic((partial :_lyric_box, locals: locals, template_engine: :slim), false, \&quot;\\n\&quot;, _temple_html_pretty1)).to_s); \n; \n; @_out_buf &lt;&lt; (\&quot;\\n&lt;div class=\\\&quot;row program-info\\\&quot;&gt;\\n  &lt;div class=\\\&quot;col-md-8\\\&quot;&gt;\\n    &lt;h1&gt;\&quot;.freeze); \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((content[:title]), true, \&quot;\\n      \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;\\n    &lt;/h1&gt;\\n    &lt;h5&gt;\\n      &lt;a\&quot;.freeze); \n; _slim_codeattributes1 = content[:source]; if _slim_codeattributes1; if _slim_codeattributes1 == true; @_out_buf &lt;&lt; (\&quot; href=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; href=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes1))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; @_out_buf &lt;&lt; (\&quot; target=\\\&quot;sheet\\\&quot;&gt;\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((\&quot;\#{content[:location]}  - \#{content[:date]}\&quot;), false, \&quot;\\n        \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;&lt;/a&gt;\\n    &lt;/h5&gt;\&quot;.freeze); if content[:links]; \n; @_out_buf &lt;&lt; (\&quot;\\n    &lt;div class=\\\&quot;mark small\\\&quot;&gt;\&quot;.freeze); \n; content[:links].each do |name, value|; \n; @_out_buf &lt;&lt; (\&quot;\\n      &lt;a\&quot;.freeze); _slim_codeattributes2 = value; if _slim_codeattributes2; if _slim_codeattributes2 == true; @_out_buf &lt;&lt; (\&quot; href=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; href=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes2))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; _slim_codeattributes3 = name; if _slim_codeattributes3; if _slim_codeattributes3 == true; @_out_buf &lt;&lt; (\&quot; target=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; target=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes3))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; @_out_buf &lt;&lt; (\&quot;&gt;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((name.capitalize), false, \&quot;\\n        \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;&lt;/a&gt;\&quot;.freeze); end; @_out_buf &lt;&lt; (\&quot;\\n    &lt;/div&gt;\&quot;.freeze); end; @_out_buf &lt;&lt; (\&quot;\\n  &lt;/div&gt;\\n  &lt;div class=\\\&quot;col-md-4\\\&quot;&gt;\\n    &lt;select class=\\\&quot;form-select\\\&quot; id=\\\&quot;list-select\\\&quot; onchange=\\\&quot;window.location.href = &amp;#39;../\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((ltype))).to_s); @_out_buf &lt;&lt; (\&quot;/&amp;#39; + this.options[this.selectedIndex].value\\\&quot;&gt;\&quot;.freeze); \n; playlists.each do |item|; \n; @_out_buf &lt;&lt; (\&quot;\\n      &lt;option\&quot;.freeze); _slim_codeattributes4 = (item == program); if _slim_codeattributes4; if _slim_codeattributes4 == true; @_out_buf &lt;&lt; (\&quot; selected=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; selected=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes4))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; _slim_codeattributes5 = item; if _slim_codeattributes5; if _slim_codeattributes5 == true; @_out_buf &lt;&lt; (\&quot; value=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; value=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes5))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; @_out_buf &lt;&lt; (\&quot;&gt;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((item), true, \&quot;\\n        \&quot;, _temple_html_pretty1)))).to_s); \n; \n; @_out_buf &lt;&lt; (\&quot;\\n      &lt;/option&gt;\&quot;.freeze); end; @_out_buf &lt;&lt; (\&quot;\\n    &lt;/select&gt;\\n  &lt;/div&gt;\\n&lt;/div&gt;\\n&lt;div class=\\\&quot;row\\\&quot;&gt;\\n  &lt;div class=\\\&quot;col-lg-12\\\&quot;&gt;\&quot;.freeze); \n; \n; \n; ismobile = (params[:static] != nil); \n; @_out_buf &lt;&lt; (\&quot;\\n    &lt;table class=\\\&quot;cell-border compact display dt-responsive\\\&quot; id=\\\&quot;main_table\\\&quot; width=\\\&quot;100%\\\&quot;&gt;\\n      &lt;thead&gt;\\n        &lt;tr&gt;\\n          &lt;th&gt;&lt;/th&gt;\\n          &lt;th&gt;\\n            Key\\n          &lt;/th&gt;\\n          &lt;th&gt;\\n            Title\\n          &lt;/th&gt;\\n          &lt;th&gt;\&quot;.freeze); \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((ltype == \&quot;list\&quot; ? \&quot;Singer [Backing]\&quot; : \&quot;List\&quot;), true, \&quot;\\n            \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;\\n          &lt;/th&gt;\\n          &lt;th&gt;\\n            Beat [Tempo]\\n          &lt;/th&gt;\\n          &lt;th&gt;\\n            Perf Video/Loops\\n          &lt;/th&gt;\\n          &lt;th&gt;\\n            Note\\n          &lt;/th&gt;\\n          &lt;th class=\\\&quot;hiddenCol\\\&quot;&gt;\\n            S-Title\\n          &lt;/th&gt;\\n        &lt;/tr&gt;\\n      &lt;/thead&gt;\\n      &lt;tbody&gt;\&quot;.freeze); \n; \n; \n; \n; \n; async = params[:static] ? &#39;false&#39; : &#39;true&#39;; \n; content[:__list].each_with_index do |e, index|; \n; row_id = \&quot;row_\#{index}\&quot;; \n; @_out_buf &lt;&lt; (\&quot;\\n        &lt;tr\&quot;.freeze); _slim_codeattributes6 = row_id; if _slim_codeattributes6; if _slim_codeattributes6 == true; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes6))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; @_out_buf &lt;&lt; (\&quot;&gt;\&quot;.freeze); \n; perf_url = e[:perf_url] || &#39;&#39;; \n; yt_video = nil; \n; tempo = e[:perf_tempo] || e[:tempo]; \n; @_out_buf &lt;&lt; (\&quot;\\n          &lt;td&gt;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((index+2), true, \&quot;\\n            \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;\\n          &lt;/td&gt;\\n          &lt;td&gt;\\n            &lt;div class=\\\&quot;d-grid gap-2\\\&quot;&gt;\&quot;.freeze); \n; \n; if !e[:lyric].empty?; \n; color = tempo_color(tempo); \n; @_out_buf &lt;&lt; (\&quot;\\n              &lt;a class=\\\&quot;btn btn-sm btn-outline-secondary chorder mtooltip\\\&quot; onClick=\\\&quot;get_lyric(&amp;#39;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((program))).to_s); @_out_buf &lt;&lt; (\&quot;&amp;#39;, &amp;#39;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((row_id))).to_s); @_out_buf &lt;&lt; (\&quot;&amp;#39;, \&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((async))).to_s); @_out_buf &lt;&lt; (\&quot;)\\\&quot; style=\\\&quot;background-color:\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((color))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot; title=\\\&quot;Lyric for: \&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((e[:title]))).to_s); @_out_buf &lt;&lt; (\&quot;, tempo: \&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((tempo))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;&gt;&lt;b&gt;\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic(((e[:key] &amp;&amp; !e[:key].empty?) ? e[:key] : &#39;?&#39;), false, \&quot;\\n                  \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;&lt;/b&gt;\&quot;.freeze); if e[:transpose]; \n; @_out_buf &lt;&lt; (\&quot;&lt;span class=\\\&quot;transpose\\\&quot; title=\\\&quot;Transpose\\\&quot;&gt;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((e[:transpose]), false, \&quot;\\n                  \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;&lt;/span&gt;\&quot;.freeze); end; @_out_buf &lt;&lt; (\&quot;&lt;span\&quot;.freeze); _temple_html_attributeremover1 = \&quot;\&quot;; if !_temple_html_attributeremover1.empty?; @_out_buf &lt;&lt; (\&quot; class=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((_temple_html_attributeremover1).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; @_out_buf &lt;&lt; (\&quot;&gt;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((e[:lead] ? \&quot; (\#{e[:lead]})\&quot; : \&quot;\&quot;), false, \&quot;\\n                  \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;&lt;/span&gt;&lt;/a&gt;\&quot;.freeze); else; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic(((e[:key] &amp;&amp; !e[:key].empty?) ? e[:key] : &#39;?&#39;), false, \&quot;\\n              \&quot;, _temple_html_pretty1)))).to_s); \n; if e[:transpose]; \n; @_out_buf &lt;&lt; (\&quot;&lt;span class=\\\&quot;transpose\\\&quot; title=\\\&quot;Transpose\\\&quot;&gt;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((e[:transpose]), false, \&quot;\\n                \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;&lt;/span&gt;\&quot;.freeze); end; end; @_out_buf &lt;&lt; (\&quot;\\n            &lt;/div&gt;\\n          &lt;/td&gt;\\n          &lt;td&gt;\&quot;.freeze); \n; if params[:static]; \n; @_out_buf &lt;&lt; (\&quot;\\n            &lt;a class=\\\&quot;msource\\\&quot; href=\\\&quot;#\\\&quot; onClick=\\\&quot;get_lyric(&amp;#39;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((program))).to_s); @_out_buf &lt;&lt; (\&quot;&amp;#39;, &amp;#39;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((row_id))).to_s); @_out_buf &lt;&lt; (\&quot;&amp;#39;, \&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((async))).to_s); @_out_buf &lt;&lt; (\&quot;)\\\&quot; title=\\\&quot;Lyric for: \&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((e[:title]))).to_s); @_out_buf &lt;&lt; (\&quot;, tempo: \&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((tempo))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;&gt;\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((e[:continue] ? \&quot;++\&quot; : \&quot;\&quot;), false, \&quot;\\n              \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((e[:title]), false, \&quot;\\n              \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;&lt;/a&gt;\&quot;.freeze); else; \n; @_out_buf &lt;&lt; (\&quot;&lt;a href=\\\&quot;../slyric/\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((program))).to_s); @_out_buf &lt;&lt; (\&quot;/\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((row_id))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;&gt;\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((e[:continue] ? \&quot;++\&quot; : \&quot;\&quot;), false, \&quot;\\n              \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((e[:title]), false, \&quot;\\n              \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;&lt;/a&gt;\&quot;.freeze); end; if e[:note] &amp;&amp; !(@isIPhone || @isIPad); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((\&quot; (\#{e[:note][0..9]})\&quot;), false, \&quot;\\n            \&quot;, _temple_html_pretty1)))).to_s); \n; end; if e[:has_style]; \n; @_out_buf &lt;&lt; (\&quot;&amp;nbsp;&lt;i class=\\\&quot;fa fa-guitar\\\&quot;&gt;&lt;/i&gt;\&quot;.freeze); \n; \n; end; @_out_buf &lt;&lt; (\&quot;\\n          &lt;/td&gt;\\n          &lt;td&gt;\&quot;.freeze); \n; if ltype == \&quot;list\&quot;; \n; unless (singer = capwords(to_stitle(e[:singer]))).empty?; \n; @_out_buf &lt;&lt; (\&quot;\\n            &lt;button class=\\\&quot;btn\\\&quot; onClick=\\\&quot;return dt_search(&amp;#39;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((singer))).to_s); @_out_buf &lt;&lt; (\&quot;&amp;#39;)\\\&quot;&gt;\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((\&quot;\#{singer}\&quot; + (e[:backing] ? \&quot; [\#{e[:backing]}]\&quot; : \&quot;\&quot;)), false, \&quot;\\n              \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;&lt;/button&gt;\&quot;.freeze); if !(@isIPad || @isIPhone); \n; @_out_buf &lt;&lt; (\&quot;&lt;a class=\\\&quot;chord\\\&quot; href=\\\&quot;../singer/\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((singer.downcase))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;&gt;&lt;i class=\\\&quot;fa fa-user\\\&quot;&gt;&lt;/i&gt;&lt;/a&gt;\&quot;.freeze); \n; \n; end; end; else; \n; unless (list = e[:singer]).empty?; \n; @_out_buf &lt;&lt; (\&quot;&lt;button class=\\\&quot;btn\\\&quot; onClick=\\\&quot;return dt_search(&amp;#39;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((singer))).to_s); @_out_buf &lt;&lt; (\&quot;&amp;#39;)\\\&quot;&gt;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((list), false, \&quot;\\n              \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;&lt;/button&gt;&lt;a class=\\\&quot;chord\\\&quot; href=\\\&quot;../list/\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((list))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;&gt;&lt;i class=\\\&quot;fa fa-list\\\&quot;&gt;&lt;/i&gt;&lt;/a&gt;\&quot;.freeze); \n; \n; end; end; @_out_buf &lt;&lt; (\&quot;\\n          &lt;/td&gt;\\n          &lt;td class=\\\&quot;dt-right\\\&quot;&gt;\\n            &lt;button class=\\\&quot;btn\\\&quot; onClick=\\\&quot;return dt_search(&amp;#39;\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((e[:beat]))).to_s); @_out_buf &lt;&lt; (\&quot;&amp;#39;)\\\&quot;&gt;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((e[:beat]), false, \&quot;\\n              \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;&lt;/button&gt;\&quot;.freeze); if tempo &amp;&amp; !(@iPhone || @iPad); \n; @_out_buf &lt;&lt; (\&quot;&lt;span class=\\\&quot;transpose text-right\\\&quot; title=\\\&quot;Tempo\\\&quot;&gt;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((tempo), false, \&quot;\\n              \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;&lt;/span&gt;\&quot;.freeze); end; @_out_buf &lt;&lt; (\&quot;\\n          &lt;/td&gt;\\n          &lt;td&gt;\&quot;.freeze); \n; perf_url = e[:perf_url] || &#39;&#39;; \n; if (yt_video = extract_yt_video(perf_url)); \n; title = e[:title].gsub(/&#39;/, &#39;&#39;); \n; @_out_buf &lt;&lt; (\&quot;\\n            &lt;button class=\\\&quot;btn btn-sm mtooltip\\\&quot; onClick=\\\&quot;return play_on_youtube(&amp;#39;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((yt_video))).to_s); @_out_buf &lt;&lt; (\&quot;&amp;#39;, &amp;#39;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((title))).to_s); @_out_buf &lt;&lt; (\&quot;&amp;#39;, 0, 0)\\\&quot; title=\\\&quot;Play \&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((yt_video))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;&gt;&lt;i class=\\\&quot;fa-solid fa-video\\\&quot;&gt;&lt;/i&gt;&lt;/button&gt;\&quot;.freeze); \n; \n; (e[:perf_loop] || []).each do |els|; \n; el = els.split(\&quot;-\&quot;).map{|f| f.to_i}; \n; @_out_buf &lt;&lt; (\&quot;&lt;button class=\\\&quot;btn btn-sm mtooltip\\\&quot; onClick=\\\&quot;return play_on_youtube(&amp;#39;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((yt_video))).to_s); @_out_buf &lt;&lt; (\&quot;&amp;#39;, &amp;#39;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((title))).to_s); @_out_buf &lt;&lt; (\&quot;&amp;#39;, \&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((el[0]))).to_s); @_out_buf &lt;&lt; (\&quot;, \&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((el[1]))).to_s); @_out_buf &lt;&lt; (\&quot;)\\\&quot; title=\\\&quot;Play loops\\\&quot;&gt;&lt;i class=\\\&quot;fa-solid fa-undo\\\&quot;&gt;&lt;/i&gt;\\n              &lt;div class=\\\&quot;loopstyle\\\&quot;&gt;\&quot;.freeze); \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((\&quot;\#{el[0]}.\#{el[1]-el[0]}\&quot;), true, \&quot;\\n                \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;\\n              &lt;/div&gt;\\n            &lt;/button&gt;\&quot;.freeze); end; elsif perf_url.start_with?(&#39;https://&#39;); \n; @_out_buf &lt;&lt; (\&quot;&lt;a\&quot;.freeze); _slim_codeattributes7 = perf_url; if _slim_codeattributes7; if _slim_codeattributes7 == true; @_out_buf &lt;&lt; (\&quot; href=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; href=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes7))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; @_out_buf &lt;&lt; (\&quot; target=\\\&quot;Listen (not embed)\\\&quot;&gt;Link&lt;/a&gt;\&quot;.freeze); \n; else; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((perf_url), false, \&quot;\\n            \&quot;, _temple_html_pretty1)))).to_s); \n; end; @_out_buf &lt;&lt; (\&quot;\\n          &lt;/td&gt;\\n          &lt;td&gt;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((e[:note] || e[:perf_note]), true, \&quot;\\n            \&quot;, _temple_html_pretty1)))).to_s); \n; @_out_buf &lt;&lt; (\&quot;\\n          &lt;/td&gt;\\n          &lt;td class=\\\&quot;hiddenCol\\\&quot;&gt;\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((e[:stitle]), true, \&quot;\\n            \&quot;, _temple_html_pretty1)))).to_s); \n; \n; @_out_buf &lt;&lt; (\&quot;\\n          &lt;/td&gt;\\n        &lt;/tr&gt;\&quot;.freeze); end; @_out_buf &lt;&lt; (\&quot;\\n      &lt;/tbody&gt;\\n    &lt;/table&gt;\\n    &lt;button class=\\\&quot;btn btn-sm btn-outline-secondary\\\&quot; onClick=\\\&quot;reset_order()\\\&quot;&gt;Reset Order &lt;/button&gt;\&quot;.freeze); \n; unless params[:static]; \n; @_out_buf &lt;&lt; (\&quot;&lt;button class=\\\&quot;btn btn-sm btn-outline-secondary\\\&quot; onClick=\\\&quot;sv_save_order()\\\&quot;&gt;Save to Server&lt;/button&gt;\&quot;.freeze); \n; \n; end; @_out_buf &lt;&lt; (\&quot;\\n  &lt;/div&gt;\\n&lt;/div&gt;\\n&lt;div class=\\\&quot;qrcode\\\&quot;&gt;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.indent_dynamic((qrcode_for(request.url)), true, \&quot;\\n  \&quot;, _temple_html_pretty1)).to_s); \n; \n; @_out_buf &lt;&lt; (\&quot;\\n&lt;/div&gt;\\n&lt;script&gt;\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.indent_dynamic((\&quot;extra = \&quot; + extra.to_json), true, \&quot;\\n  \&quot;, _temple_html_pretty1)).to_s); \n; \n; @_out_buf &lt;&lt; (\&quot;\\n&lt;/script&gt;\&quot;.freeze); tname = File.basename(__FILE__); \n; content_for :javascript do; \n; @_out_buf &lt;&lt; (\&quot;\\n&lt;script src=\\\&quot;https://www.youtube.com/iframe_api\\\&quot;&gt;&lt;/script&gt;\\n&lt;script&gt;\\n  var main_table;\\n  var myModal;\\n  \\n  $(function() {\\n  \\n    $(&#39;.mtooltip&#39;).tooltip()\\n  \\n    main_table = new DataTable(&#39;#main_table&#39;, {\\n      layout: {\\n        topStart:    &#39;search&#39;,\\n        bottomStart: &#39;info&#39;,\\n      },\\n      search: {\\n        search: &#39;\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((params[:search]), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;&#39;,\\n        caseInsensitive: true,\\n      },\\n      responsive: true,\\n      paging:     false,\\n      columns: [{data: &#39;id&#39;}, null, {data: &#39;title&#39;},\\n                null, null, null, null],\\n      order:  [[ 0, \\\&quot;asc\\\&quot; ]],\\n      columnDefs: [\\n        { target: 1, visible: true,  searchable: false },\\n        { target: 2, width: \\\&quot;40%\\\&quot; },\\n        { target: 6, visible: false, searchable: true },\\n        { target: 7, visible: false, searchable: true },\\n      ],\\n      rowReorder: {\\n        dataSrc: &#39;id&#39;,\\n      },\\n      initComplete: function(settings, json) {\\n        var newkey  = &#39;&#39;\\n        for (let value of $(&#39;#main_table tbody tr&#39;)) {\\n          newkey += value.childNodes[3].innerText.replace(/[\\\\(\\\\) ]/g, \\\&quot;\\\&quot;)\\n        }\\n        let curkey = localStorage.getItem(&#39;pagekey.\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((program), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;&#39;)\\n        console.log(`\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((tname), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;:\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((__LINE__), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; \&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((program), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; curkey: ${curkey}`)\\n        console.log(`\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((tname), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;:\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((__LINE__), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; \&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((program), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; newkey: ${newkey}`)\\n        localStorage.setItem(\\\&quot;pagekey.\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((program), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;, newkey)\\n        if (curkey == newkey) {\\n          restore_order()\\n        }\\n      }\\n    });\\n  \\n    main_table.on(&#39;row-reorder&#39;, (e, diff, edit) =&gt; {\\n      setTimeout(() =&gt; { save_order() }, 100)\\n    })\\n  \\n    myModal  = new bootstrap.Modal(document.getElementById(&#39;lybox&#39;))\\n  });\\n  \\n  function reset_order() {\\n    localStorage.removeItem(\\\&quot;pageorder.\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((program), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;)\\n    location.reload()\\n  }\\n  \\n  function current_order() {\\n    var olist = []\\n    for (value of $(&#39;#main_table tbody tr&#39;)) {\\n      // console.log(&#39;rowid&#39;, value.id)\\n      olist.push(value.id)\\n    }\\n    return olist\\n  }\\n  \\n  // Save order to localstore (per device only)\\n  function save_order() {\\n    var olist = current_order()\\n    console.log(`\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((tname), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;:\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((__LINE__), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; new_list: ${olist}`)\\n    localStorage.setItem(\\\&quot;pageorder.\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((program), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;, JSON.stringify(olist))\\n  }\\n  \\n  // Save order to server (so it could be shared)\\n  function sv_save_order() {\\n    var olist = current_order()\\n    var url = `../reorder/\&quot;.freeze); \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((program), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;/${olist.join(&#39;,&#39;)}`\\n    jQuery.ajax({\\n      url:      url,\\n      method:   &#39;POST&#39;,\\n      async:    false,\\n      dataType: &#39;json&#39;,\\n      success:  location.reload(),\\n    });\\n  }\\n  \\n  function restore_order() {\\n    let item = localStorage.getItem(\\\&quot;pageorder.\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((program), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;)\\n    if (item == null) {\\n      console.log(`\&quot;.freeze); \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((tname), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;:\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((__LINE__), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; No order to restore`)\\n      return\\n    }\\n  \\n    let olist   = JSON.parse(item)\\n    let dt_rows = $(&#39;#main_table tbody tr&#39;)\\n    var offset  = 2\\n    console.log(`\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((tname), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;:\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((__LINE__), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; Restore olist: ${olist}`)\\n  \\n    for (rowno of olist) {\\n      // console.log(&#39;rowno: &#39;, rowno)\\n      // console.log(&#39;dtrow: &#39;, dt_rows[rowno])\\n  \\n      if (dt_rows[rowno] == null) {\\n        continue\\n      }\\n      let listno = dt_rows[rowno].childNodes[2].innerText\\n      dt_rows[rowno].childNodes[2].innerText = offset\\n      offset += 1\\n    }\\n  \\n    setTimeout(() =&gt; {\\n      main_table.rows().invalidate().draw()\\n    }, 100)\\n  }\\n&lt;/script&gt;\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; end; @_out_buf; ensure; @_out_buf = _temple_generators_stringbuffer1; end&quot;&gt;, [:slim, :_pl_player, {:template_engine=&gt;:slim, :outvar=&gt;&quot;@_out_buf&quot;, :default_encoding=&gt;&quot;utf-8&quot;}, &quot;/app/controllers/../views&quot;]=&gt;#&lt;Slim::Template:0x00007fd726dc1770 @options={:template_engine=&gt;:slim, :outvar=&gt;&quot;@_out_buf&quot;}, @line=1, @file=&quot;/app/controllers/../views/_pl_player.slim&quot;, @compiled_method={[PlaylistPortal, [:height, :id, :width]]=&gt;#&lt;UnboundMethod: Tilt::CompiledTemplates#__tilt_685680(locals) /app/controllers/../views/_pl_player.slim:-4&gt;}, @default_encoding=&quot;utf-8&quot;, @skip_compiled_encoding_detection=nil, @data=&quot;- # Using YT iFrame API, more flexible but cannot deployed as static file\n\n- vtitle    = \&quot;\#{id}-title\&quot;\n- vplayer   = \&quot;\#{id}-player\&quot;\n- vcloser   = \&quot;\#{id}-closer\&quot;\n- opacity   ||= 0.4\n\n- content_for :css do\n  css:\n    #\#{vplayer} {\n      width:    \#{width};\n      height:   \#{height};\n      opacity:  \#{opacity};\n    }\n    #\#{vcloser} {\n      position: absolute;\n      top:      0;\n      right:    0;\n      z-index:  99;\n    }\n\ndiv id=id\n  div\n    a id=vcloser href=&#39;#&#39; onClick=\&quot;cancel_play(); return false\&quot;\n      i.fa.fa-2x.fa-window-close\n    span id=vtitle style=\&quot;font-size:60%\&quot;\n  div id=vplayer\n\n- content_for :javascript do\n  - tname = File.basename(__FILE__)\n  javascript:\n    var player = null;\n    var play_timer = null;\n\n    // This function will be called when the API is ready\n    function onYouTubeIframeAPIReady() {\n      console.log(`\#{tname}:\#{__LINE__} Frame API ready`)\n      player = new YT.Player(&#39;\#{vplayer}&#39;, {\n        videoId: &#39;&#39;,\n        playerVars: {\n            autoplay:       1,\n            controls:       1,\n            showinfo:       0,\n            modestbranding: 1,\n        },\n      });\n    }\n\n    function cancel_play() {\n      cancel_play_timer()\n      player.stopVideo();\n      $(&#39;#\#{id}&#39;).hide();\n    }\n\n    function cancel_play_timer() {\n      if (play_timer) {\n        clearTimeout(play_timer);\n        play_timer = null\n      }\n    }\n\n    function loopPlay(stime, etime) {\n      console.log(`Seeking to ${stime}. Play for ${etime - stime}`)\n\n      // In case a loop play precede.  Must cancel any play timer\n      cancel_play_timer();\n      player.seekTo(stime, true)\n      if (etime &lt;= stime) {\n        return\n      }\n\n      // Looping play\n      var duration = etime - stime\n      play_timer = setTimeout(function() {\n        loopPlay(stime, etime);\n      }, duration*1000);\n      // console.log(&#39;Starting timer: &#39;, play_timer, &#39; duration: &#39;, duration)\n    }\n\n    function play_on_youtube(video, title, stime, etime) {\n      if (player == null) {\n        alert(\&quot;Youtube player is not ready\&quot;)\n        return\n      }\n      var href = `https://www.youtube.com/embed/${video}?autoplay=1&amp;playsinline=1`;\n      console.log(href, stime, etime)\n\n      $(&#39;#\#{vtitle}&#39;)[0].innerHTML = title\n      player.loadVideoById(video, stime)\n      player.seekTo(stime, true)\n\n      /* Slow down player */\n      if (etime &gt; 0) {\n        const prate = 1\n        player.setPlaybackRate(prate);\n        etime2 = stime + ((etime - stime)/prate);\n      }\n\n      // 1st seek somehow have to wait a bit ...\n      setTimeout(function() {\n        player.unMute()\n        $(&#39;#\#{id}&#39;).show();\n        loopPlay(stime, etime);\n      }, 500)\n    }\n\n  -# Script must be loaded last after trigger is in place\n\n  script src=\&quot;https://www.youtube.com/iframe_api\&quot;\n&quot;, @src=&quot;begin; _temple_generators_stringbuffer1 = @_out_buf if defined?(@_out_buf); @_out_buf = &#39;&#39;.dup; _temple_html_pretty1 = /&lt;code|&lt;pre|&lt;textarea/; # Using YT iFrame API, more flexible but cannot deployed as static file; \n; \n; vtitle    = \&quot;\#{id}-title\&quot;; \n; vplayer   = \&quot;\#{id}-player\&quot;; \n; vcloser   = \&quot;\#{id}-closer\&quot;; \n; opacity   ||= 0.4; \n; \n; content_for :css do; \n; @_out_buf &lt;&lt; (\&quot;&lt;style&gt;\\n  #\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((vplayer), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; {\\n    width:    \&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((width), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;;\\n    height:   \&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((height), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;;\\n    opacity:  \&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((opacity), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;;\\n  }\\n  #\&quot;.freeze); \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((vcloser), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; {\\n    position: absolute;\\n    top:      0;\\n    right:    0;\\n    z-index:  99;\\n  }\\n&lt;/style&gt;\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; end; @_out_buf &lt;&lt; (\&quot;\\n&lt;div\&quot;.freeze); _slim_codeattributes1 = id; if _slim_codeattributes1; if _slim_codeattributes1 == true; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes1))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; @_out_buf &lt;&lt; (\&quot;&gt;\\n  &lt;div&gt;\\n    &lt;a href=\\\&quot;#\\\&quot;\&quot;.freeze); \n; \n; _slim_codeattributes2 = vcloser; if _slim_codeattributes2; if _slim_codeattributes2 == true; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes2))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; @_out_buf &lt;&lt; (\&quot; onClick=\\\&quot;cancel_play(); return false\\\&quot;&gt;&lt;i class=\\\&quot;fa fa-2x fa-window-close\\\&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;span\&quot;.freeze); \n; \n; _slim_codeattributes3 = vtitle; if _slim_codeattributes3; if _slim_codeattributes3 == true; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes3))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; @_out_buf &lt;&lt; (\&quot; style=\\\&quot;font-size:60%\\\&quot;&gt;&lt;/span&gt;\\n  &lt;/div&gt;\\n  &lt;div\&quot;.freeze); \n; _slim_codeattributes4 = vplayer; if _slim_codeattributes4; if _slim_codeattributes4 == true; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes4))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; @_out_buf &lt;&lt; (\&quot;&gt;&lt;/div&gt;\\n&lt;/div&gt;\&quot;.freeze); \n; \n; content_for :javascript do; \n; tname = File.basename(__FILE__); \n; @_out_buf &lt;&lt; (\&quot;\\n&lt;script&gt;\\n  var player = null;\\n  var play_timer = null;\\n  \\n  // This function will be called when the API is ready\\n  function onYouTubeIframeAPIReady() {\\n    console.log(`\&quot;.freeze); \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((tname), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;:\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((__LINE__), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; Frame API ready`)\\n    player = new YT.Player(&#39;\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((vplayer), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;&#39;, {\\n      videoId: &#39;&#39;,\\n      playerVars: {\\n          autoplay:       1,\\n          controls:       1,\\n          showinfo:       0,\\n          modestbranding: 1,\\n      },\\n    });\\n  }\\n  \\n  function cancel_play() {\\n    cancel_play_timer()\\n    player.stopVideo();\\n    $(&#39;#\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((id), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;&#39;).hide();\\n  }\\n  \\n  function cancel_play_timer() {\\n    if (play_timer) {\\n      clearTimeout(play_timer);\\n      play_timer = null\\n    }\\n  }\\n  \\n  function loopPlay(stime, etime) {\\n    console.log(`Seeking to ${stime}. Play for ${etime - stime}`)\\n  \\n    // In case a loop play precede.  Must cancel any play timer\\n    cancel_play_timer();\\n    player.seekTo(stime, true)\\n    if (etime &lt;= stime) {\\n      return\\n    }\\n  \\n    // Looping play\\n    var duration = etime - stime\\n    play_timer = setTimeout(function() {\\n      loopPlay(stime, etime);\\n    }, duration*1000);\\n    // console.log(&#39;Starting timer: &#39;, play_timer, &#39; duration: &#39;, duration)\\n  }\\n  \\n  function play_on_youtube(video, title, stime, etime) {\\n    if (player == null) {\\n      alert(\\\&quot;Youtube player is not ready\\\&quot;)\\n      return\\n    }\\n    var href = `https://www.youtube.com/embed/${video}?autoplay=1&amp;playsinline=1`;\\n    console.log(href, stime, etime)\\n  \\n    $(&#39;#\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((vtitle), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;&#39;)[0].innerHTML = title\\n    player.loadVideoById(video, stime)\\n    player.seekTo(stime, true)\\n  \\n    /* Slow down player */\\n    if (etime &gt; 0) {\\n      const prate = 1\\n      player.setPlaybackRate(prate);\\n      etime2 = stime + ((etime - stime)/prate);\\n    }\\n  \\n    // 1st seek somehow have to wait a bit ...\\n    setTimeout(function() {\\n      player.unMute()\\n      $(&#39;#\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((id), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;&#39;).show();\\n      loopPlay(stime, etime);\\n    }, 500)\\n  }\\n&lt;/script&gt;\&quot;.freeze); \n; \n; \n; \n; \n; # Script must be loaded last after trigger is in place; \n; \n; @_out_buf &lt;&lt; (\&quot;\\n&lt;script src=\\\&quot;https://www.youtube.com/iframe_api\\\&quot;&gt;&lt;/script&gt;\&quot;.freeze); \n; end; @_out_buf; ensure; @_out_buf = _temple_generators_stringbuffer1; end&quot;&gt;, [:slim, :_lyric_box, {:template_engine=&gt;:slim, :outvar=&gt;&quot;@_out_buf&quot;, :default_encoding=&gt;&quot;utf-8&quot;}, &quot;/app/controllers/../views&quot;]=&gt;#&lt;Slim::Template:0x00007fd726e5c4a0 @options={:template_engine=&gt;:slim, :outvar=&gt;&quot;@_out_buf&quot;}, @line=1, @file=&quot;/app/controllers/../views/_lyric_box.slim&quot;, @compiled_method={[PlaylistPortal, [:id, :ltype]]=&gt;#&lt;UnboundMethod: Tilt::CompiledTemplates#__tilt_685680(locals) /app/controllers/../views/_lyric_box.slim:-3&gt;}, @default_encoding=&quot;utf-8&quot;, @skip_compiled_encoding_detection=nil, @data=&quot;- ltitle    = \&quot;\#{id}-title\&quot;\n- ldebug    = \&quot;\#{id}-debug\&quot;\n- lheader   = \&quot;\#{id}-header\&quot;\n- lcontent  = \&quot;\#{id}-content\&quot;\n- video_ctl = \&quot;\#{id}-vctl\&quot;\n\n- content_for :css do\n  css:\n    .chord {\n      color:            #aa5;\n      vertical-align:   12px;\n      font-family:      monospace;\n      font-weight:      800;\n      padding:          2px;\n      border-bottom:    1px solid #888;\n      font-size:        80%;\n      background-color: #ffc;\n    }\n    #\#{ltitle} {\n      font-size: 80%;\n    }\n    #\#{lcontent} {\n      font-size: 150%;\n    }\n    #\#{ldebug} {\n      font-size: 50%;\n    }\n\n/! Lyric modal - hidden until brought up\n.modal.fade id=id tabindex=-1\n  .modal-dialog.modal-dialog-centered.modal-dialog-scrollable.modal-xl style=\&quot;max-width:100%; max-height:100%\&quot;\n    .modal-content\n      .modal-header\n        div.small id=lheader\n        div.small id=ldebug\n        div id=video_ctl\n          button.btn.btn-secondary type=\&quot;button\&quot; onClick=\&quot;play_song()\&quot; title=\&quot;Play full video\&quot;\n            i.fa-solid.fa-headphones\n          button.btn.btn-secondary type=\&quot;button\&quot; onClick=\&quot;play_intro()\&quot; title=\&quot;Play intro\&quot;\n            i.fa-solid.fa-undo\n          button.btn.btn-secondary type=\&quot;button\&quot; onClick=\&quot;cancel_play()\&quot; title=\&quot;Stop plauing\&quot;\n            i.fa-solid.fa-stop\n      .modal-body\n        div id=lcontent\n      .modal-footer\n        div id=ltitle\n        - async = params[:static] ? &#39;false&#39; : &#39;true&#39;\n        button.btn.btn-secondary type=\&quot;button\&quot; onClick=\&quot;load_lyric(\#{async}, -1)\&quot; title=\&quot;Previous Page\&quot;\n          i.fa.fa-backward\n        - unless params[:static]\n          button.btn.btn-secondary type=\&quot;button\&quot; onClick=\&quot;load_lyric(\#{async}, 0)\&quot; title=\&quot;Reload Page\&quot;\n            i.fa-solid.fa-undo\n        button.btn.btn-secondary type=\&quot;button\&quot; onClick=\&quot;singer_toggle()\&quot; title=\&quot;Toogle chord\&quot;\n          i.fa.fa-music\n        button.btn.btn-secondary type=\&quot;button\&quot; onClick=\&quot;load_lyric(\#{async}, 1)\&quot; title=\&quot;Next Page\&quot;\n          i.fa.fa-forward\n        button.btn.btn-warning type=\&quot;button\&quot; data-bs-dismiss=\&quot;modal\&quot; title=\&quot;Close\&quot;\n          i.fa.fa-sign-out\n\n- tname = File.basename(__FILE__)\njavascript:\n  function singer_toggle() {\n    $(&#39;.chord&#39;).toggle()\n    $(&#39;#\#{id} .modal-header&#39;).toggle()\n  }\n\n  function load_lyric(async = true, offset = 0) {\n    var olist = current_order()\n\n    // console.log(`\#{tname}:\#{__LINE__} olist: ${olist}`)\n    var cur_ofs = olist.indexOf(myModal.item.toString())\n    var new_ofs = cur_ofs + offset\n    console.log(`\#{tname}:\#{__LINE__} cur:${cur_ofs}, new: ${new_ofs}`)\n\n    if ((new_ofs &lt; 0) || (new_ofs &gt;= olist.length)) {\n      return\n    }\n    get_lyric(myModal.program, olist[new_ofs], async)\n  }\n  function play_intro() {\n    var lvideo = $(&#39;#\#{video_ctl}&#39;)\n    var video  = lvideo.attr(&#39;my_video&#39;)\n    var stime  = parseInt(lvideo.attr(&#39;my_vstart&#39;))\n    var etime  = parseInt(lvideo.attr(&#39;my_vend&#39;))\n    var title  = lvideo.attr(&#39;my_title&#39;)\n    play_on_youtube(video, title, stime, etime)\n  }\n  function play_song() {\n    var lvideo = $(&#39;#\#{video_ctl}&#39;)\n    var video = lvideo.attr(&#39;my_video&#39;)\n    var title = lvideo.attr(&#39;my_title&#39;)\n    play_on_youtube(video, title, 0, 0)\n  }\n  function get_lyric(program, item, async = true) {\n    myModal.program = program\n    myModal.item    = item\n\n    console.log(`\#{tname}:\#{__LINE__} Getting item # ${myModal.item}`)\n\n    if (async) {\n      var url = `../lyric/${program}/${item}?type=\#{ltype}`\n      jQuery.ajax({\n        url:      url,\n        async:    true,\n        dataType: &#39;json&#39;,\n        success:  show_lyric,\n      });\n    } else {\n      var iitem = parseInt(item.substring(4), 10)\n      var content  = extra[iitem]\n      if (content != null) {\n        show_lyric(content)\n      }\n    }\n  }\n  function show_lyric(content) {\n    // console.log(`\#{tname}:\#{__LINE__}`, content)\n    var lvideo = $(&#39;#\#{video_ctl}&#39;)\n\n    // If vintro exist - create button for play/stop intro\n    lvideo.attr(&#39;my_video&#39;,  content[&#39;video&#39;])\n    lvideo.attr(&#39;my_title&#39;,  content[&#39;title&#39;])\n    lvideo.attr(&#39;my_item&#39;,   content[&#39;item_no&#39;])\n\n    if (content[&#39;vintro&#39;] != null) {\n      lvideo.attr(&#39;my_vstart&#39;, content[&#39;vintro&#39;][0])\n      lvideo.attr(&#39;my_vend&#39;,   content[&#39;vintro&#39;][1])\n    }\n    lvideo.show()\n\n    var lyric = content[&#39;lyric&#39;].replaceAll(&#39;\\n&#39;, &#39;&lt;br&gt;&#39;)\n    $(&#39;#\#{lcontent}&#39;).html(&#39;&lt;center&gt;&lt;b&gt;&#39; + lyric)\n    $(&#39;#\#{lheader}&#39;).html(`${content[&#39;beat&#39;]}: ${content[&#39;tokey&#39;]}.${content[&#39;transpose&#39;]}\#${content[&#39;tempo&#39;]} - Intro: ${content[&#39;intro&#39;]}`)\n    $(&#39;#\#{ltitle}&#39;).html(`&lt;a href=${content[&#39;source&#39;]}&gt;${content[&#39;title&#39;].substring(0, 19)}&lt;/a&gt;`)\n    $(&#39;.modal-header&#39;).show()\n    myModal.show()\n  }\n&quot;, @src=&quot;begin; _temple_generators_stringbuffer1 = @_out_buf if defined?(@_out_buf); @_out_buf = &#39;&#39;.dup; _temple_html_pretty1 = /&lt;code|&lt;pre|&lt;textarea/; ltitle    = \&quot;\#{id}-title\&quot;; \n; ldebug    = \&quot;\#{id}-debug\&quot;; \n; lheader   = \&quot;\#{id}-header\&quot;; \n; lcontent  = \&quot;\#{id}-content\&quot;; \n; video_ctl = \&quot;\#{id}-vctl\&quot;; \n; \n; content_for :css do; \n; @_out_buf &lt;&lt; (\&quot;&lt;style&gt;\\n  .chord {\\n    color:            #aa5;\\n    vertical-align:   12px;\\n    font-family:      monospace;\\n    font-weight:      800;\\n    padding:          2px;\\n    border-bottom:    1px solid #888;\\n    font-size:        80%;\\n    background-color: #ffc;\\n  }\\n  #\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((ltitle), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; {\\n    font-size: 80%;\\n  }\\n  #\&quot;.freeze); \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((lcontent), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; {\\n    font-size: 150%;\\n  }\\n  #\&quot;.freeze); \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((ldebug), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; {\\n    font-size: 50%;\\n  }\\n&lt;/style&gt;\&quot;.freeze); \n; \n; \n; \n; end; @_out_buf &lt;&lt; (\&quot;\\n&lt;!--Lyric modal - hidden until brought up--&gt;\\n&lt;div class=\\\&quot;modal fade\\\&quot;\&quot;.freeze); \n; _slim_codeattributes1 = id; if _slim_codeattributes1; if _slim_codeattributes1 == true; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes1))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; _slim_codeattributes2 = -1; if _slim_codeattributes2; if _slim_codeattributes2 == true; @_out_buf &lt;&lt; (\&quot; tabindex=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; tabindex=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes2))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; @_out_buf &lt;&lt; (\&quot;&gt;\\n  &lt;div class=\\\&quot;modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl\\\&quot; style=\\\&quot;max-width:100%; max-height:100%\\\&quot;&gt;\\n    &lt;div class=\\\&quot;modal-content\\\&quot;&gt;\\n      &lt;div class=\\\&quot;modal-header\\\&quot;&gt;\\n        &lt;div class=\\\&quot;small\\\&quot;\&quot;.freeze); \n; \n; \n; \n; _slim_codeattributes3 = lheader; if _slim_codeattributes3; if _slim_codeattributes3 == true; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes3))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; @_out_buf &lt;&lt; (\&quot;&gt;&lt;/div&gt;\\n        &lt;div class=\\\&quot;small\\\&quot;\&quot;.freeze); \n; _slim_codeattributes4 = ldebug; if _slim_codeattributes4; if _slim_codeattributes4 == true; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes4))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; @_out_buf &lt;&lt; (\&quot;&gt;&lt;/div&gt;\\n        &lt;div\&quot;.freeze); \n; _slim_codeattributes5 = video_ctl; if _slim_codeattributes5; if _slim_codeattributes5 == true; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes5))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; @_out_buf &lt;&lt; (\&quot;&gt;\\n          &lt;button class=\\\&quot;btn btn-secondary\\\&quot; onClick=\\\&quot;play_song()\\\&quot; title=\\\&quot;Play full video\\\&quot; type=\\\&quot;button\\\&quot;&gt;&lt;i class=\\\&quot;fa-solid fa-headphones\\\&quot;&gt;&lt;/i&gt;&lt;/button&gt;&lt;button class=\\\&quot;btn btn-secondary\\\&quot; onClick=\\\&quot;play_intro()\\\&quot; title=\\\&quot;Play intro\\\&quot; type=\\\&quot;button\\\&quot;&gt;&lt;i class=\\\&quot;fa-solid fa-undo\\\&quot;&gt;&lt;/i&gt;&lt;/button&gt;&lt;button class=\\\&quot;btn btn-secondary\\\&quot; onClick=\\\&quot;cancel_play()\\\&quot; title=\\\&quot;Stop plauing\\\&quot; type=\\\&quot;button\\\&quot;&gt;&lt;i class=\\\&quot;fa-solid fa-stop\\\&quot;&gt;&lt;/i&gt;&lt;/button&gt;\\n        &lt;/div&gt;\\n      &lt;/div&gt;\\n      &lt;div class=\\\&quot;modal-body\\\&quot;&gt;\\n        &lt;div\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; _slim_codeattributes6 = lcontent; if _slim_codeattributes6; if _slim_codeattributes6 == true; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes6))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; @_out_buf &lt;&lt; (\&quot;&gt;&lt;/div&gt;\\n      &lt;/div&gt;\\n      &lt;div class=\\\&quot;modal-footer\\\&quot;&gt;\\n        &lt;div\&quot;.freeze); \n; \n; _slim_codeattributes7 = ltitle; if _slim_codeattributes7; if _slim_codeattributes7 == true; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\\\&quot;\&quot;.freeze); else; @_out_buf &lt;&lt; (\&quot; id=\\\&quot;\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((_slim_codeattributes7))).to_s); @_out_buf &lt;&lt; (\&quot;\\\&quot;\&quot;.freeze); end; end; @_out_buf &lt;&lt; (\&quot;&gt;&lt;/div&gt;\&quot;.freeze); \n; async = params[:static] ? &#39;false&#39; : &#39;true&#39;; \n; @_out_buf &lt;&lt; (\&quot;\\n        &lt;button class=\\\&quot;btn btn-secondary\\\&quot; onClick=\\\&quot;load_lyric(\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((async))).to_s); @_out_buf &lt;&lt; (\&quot;, -1)\\\&quot; title=\\\&quot;Previous Page\\\&quot; type=\\\&quot;button\\\&quot;&gt;&lt;i class=\\\&quot;fa fa-backward\\\&quot;&gt;&lt;/i&gt;&lt;/button&gt;\&quot;.freeze); \n; \n; unless params[:static]; \n; @_out_buf &lt;&lt; (\&quot;&lt;button class=\\\&quot;btn btn-secondary\\\&quot; onClick=\\\&quot;load_lyric(\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((async))).to_s); @_out_buf &lt;&lt; (\&quot;, 0)\\\&quot; title=\\\&quot;Reload Page\\\&quot; type=\\\&quot;button\\\&quot;&gt;&lt;i class=\\\&quot;fa-solid fa-undo\\\&quot;&gt;&lt;/i&gt;&lt;/button&gt;\&quot;.freeze); \n; \n; end; @_out_buf &lt;&lt; (\&quot;&lt;button class=\\\&quot;btn btn-secondary\\\&quot; onClick=\\\&quot;singer_toggle()\\\&quot; title=\\\&quot;Toogle chord\\\&quot; type=\\\&quot;button\\\&quot;&gt;&lt;i class=\\\&quot;fa fa-music\\\&quot;&gt;&lt;/i&gt;&lt;/button&gt;&lt;button class=\\\&quot;btn btn-secondary\\\&quot; onClick=\\\&quot;load_lyric(\&quot;.freeze); \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((async))).to_s); @_out_buf &lt;&lt; (\&quot;, 1)\\\&quot; title=\\\&quot;Next Page\\\&quot; type=\\\&quot;button\\\&quot;&gt;&lt;i class=\\\&quot;fa fa-forward\\\&quot;&gt;&lt;/i&gt;&lt;/button&gt;&lt;button class=\\\&quot;btn btn-warning\\\&quot; data-bs-dismiss=\\\&quot;modal\\\&quot; title=\\\&quot;Close\\\&quot; type=\\\&quot;button\\\&quot;&gt;&lt;i class=\\\&quot;fa fa-sign-out\\\&quot;&gt;&lt;/i&gt;&lt;/button&gt;\\n      &lt;/div&gt;\\n    &lt;/div&gt;\\n  &lt;/div&gt;\\n&lt;/div&gt;\&quot;.freeze); \n; \n; \n; \n; \n; tname = File.basename(__FILE__); \n; @_out_buf &lt;&lt; (\&quot;\\n&lt;script&gt;\\n  function singer_toggle() {\\n    $(&#39;.chord&#39;).toggle()\\n    $(&#39;#\&quot;.freeze); \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((id), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; .modal-header&#39;).toggle()\\n  }\\n  \\n  function load_lyric(async = true, offset = 0) {\\n    var olist = current_order()\\n  \\n    // console.log(`\&quot;.freeze); \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((tname), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;:\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((__LINE__), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; olist: ${olist}`)\\n    var cur_ofs = olist.indexOf(myModal.item.toString())\\n    var new_ofs = cur_ofs + offset\\n    console.log(`\&quot;.freeze); \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((tname), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;:\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((__LINE__), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; cur:${cur_ofs}, new: ${new_ofs}`)\\n  \\n    if ((new_ofs &lt; 0) || (new_ofs &gt;= olist.length)) {\\n      return\\n    }\\n    get_lyric(myModal.program, olist[new_ofs], async)\\n  }\\n  function play_intro() {\\n    var lvideo = $(&#39;#\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((video_ctl), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;&#39;)\\n    var video  = lvideo.attr(&#39;my_video&#39;)\\n    var stime  = parseInt(lvideo.attr(&#39;my_vstart&#39;))\\n    var etime  = parseInt(lvideo.attr(&#39;my_vend&#39;))\\n    var title  = lvideo.attr(&#39;my_title&#39;)\\n    play_on_youtube(video, title, stime, etime)\\n  }\\n  function play_song() {\\n    var lvideo = $(&#39;#\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((video_ctl), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;&#39;)\\n    var video = lvideo.attr(&#39;my_video&#39;)\\n    var title = lvideo.attr(&#39;my_title&#39;)\\n    play_on_youtube(video, title, 0, 0)\\n  }\\n  function get_lyric(program, item, async = true) {\\n    myModal.program = program\\n    myModal.item    = item\\n  \\n    console.log(`\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((tname), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;:\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((__LINE__), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot; Getting item # ${myModal.item}`)\\n  \\n    if (async) {\\n      var url = `../lyric/${program}/${item}?type=\&quot;.freeze); \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((ltype), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;`\\n      jQuery.ajax({\\n        url:      url,\\n        async:    true,\\n        dataType: &#39;json&#39;,\\n        success:  show_lyric,\\n      });\\n    } else {\\n      var iitem = parseInt(item.substring(4), 10)\\n      var content  = extra[iitem]\\n      if (content != null) {\\n        show_lyric(content)\\n      }\\n    }\\n  }\\n  function show_lyric(content) {\\n    // console.log(`\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((tname), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;:\&quot;.freeze); @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((__LINE__), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;`, content)\\n    var lvideo = $(&#39;#\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((video_ctl), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;&#39;)\\n  \\n    // If vintro exist - create button for play/stop intro\\n    lvideo.attr(&#39;my_video&#39;,  content[&#39;video&#39;])\\n    lvideo.attr(&#39;my_title&#39;,  content[&#39;title&#39;])\\n    lvideo.attr(&#39;my_item&#39;,   content[&#39;item_no&#39;])\\n  \\n    if (content[&#39;vintro&#39;] != null) {\\n      lvideo.attr(&#39;my_vstart&#39;, content[&#39;vintro&#39;][0])\\n      lvideo.attr(&#39;my_vend&#39;,   content[&#39;vintro&#39;][1])\\n    }\\n    lvideo.show()\\n  \\n    var lyric = content[&#39;lyric&#39;].replaceAll(&#39;\\\\n&#39;, &#39;&lt;br&gt;&#39;)\\n    $(&#39;#\&quot;.freeze); \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((lcontent), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;&#39;).html(&#39;&lt;center&gt;&lt;b&gt;&#39; + lyric)\\n    $(&#39;#\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((lheader), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;&#39;).html(`${content[&#39;beat&#39;]}: ${content[&#39;tokey&#39;]}.${content[&#39;transpose&#39;]}\\\#${content[&#39;tempo&#39;]} - Intro: ${content[&#39;intro&#39;]}`)\\n    $(&#39;#\&quot;.freeze); \n; @_out_buf &lt;&lt; ((::Temple::Utils.escape_html((::Temple::Utils.indent_dynamic((ltitle), false, \&quot;\\n  \&quot;, _temple_html_pretty1)))).to_s); @_out_buf &lt;&lt; (\&quot;&#39;).html(`&lt;a href=${content[&#39;source&#39;]}&gt;${content[&#39;title&#39;].substring(0, 19)}&lt;/a&gt;`)\\n    $(&#39;.modal-header&#39;).show()\\n    myModal.show()\\n  }\\n&lt;/script&gt;\&quot;.freeze); \n; \n; \n; \n; @_out_buf; ensure; @_out_buf = _temple_generators_stringbuffer1; end&quot;&gt;}&gt;, @pinned_response=nil&gt;, @options={:reaction=&gt;:drop_session, :logging=&gt;true, :message=&gt;&quot;Forbidden&quot;, :encryptor=&gt;Digest::SHA1, :session_key=&gt;&quot;rack.session&quot;, :status=&gt;403, :allow_empty_referrer=&gt;true, :report_key=&gt;&quot;protection.failed&quot;, :html_types=&gt;[&quot;text/html&quot;, &quot;application/xhtml&quot;, &quot;text/xml&quot;, &quot;application/xml&quot;], :xss_mode=&gt;:block, :nosniff=&gt;true, :img_src=&gt;&quot;&#39;self&#39; data:&quot;, :font_src=&gt;&quot;&#39;self&#39;&quot;, :without_session=&gt;false}&gt;, @options={:reaction=&gt;:drop_session, :logging=&gt;true, :message=&gt;&quot;Forbidden&quot;, :encryptor=&gt;Digest::SHA1, :session_key=&gt;&quot;rack.session&quot;, :status=&gt;403, :allow_empty_referrer=&gt;true, :report_key=&gt;&quot;protection.failed&quot;, :html_types=&gt;[&quot;text/html&quot;, &quot;application/xhtml&quot;, &quot;text/xml&quot;, &quot;application/xml&quot;], :authenticity_param=&gt;&quot;authenticity_token&quot;, :key=&gt;:csrf, :allow_if=&gt;nil, :img_src=&gt;&quot;&#39;self&#39; data:&quot;, :font_src=&gt;&quot;&#39;self&#39;&quot;, :without_session=&gt;false}&gt;, @options={:reaction=&gt;:drop_session, :logging=&gt;true, :message=&gt;&quot;Forbidden&quot;, :encryptor=&gt;Digest::SHA1, :session_key=&gt;&quot;rack.session&quot;, :status=&gt;403, :allow_empty_referrer=&gt;true, :report_key=&gt;&quot;protection.failed&quot;, :html_types=&gt;[&quot;text/html&quot;, &quot;application/xhtml&quot;, &quot;text/xml&quot;, &quot;application/xml&quot;], :img_src=&gt;&quot;&#39;self&#39; data:&quot;, :font_src=&gt;&quot;&#39;self&#39;&quot;, :without_session=&gt;false}&gt;, @options={:reaction=&gt;:drop_session, :logging=&gt;true, :message=&gt;&quot;Forbidden&quot;, :encryptor=&gt;Digest::SHA1, :session_key=&gt;&quot;rack.session&quot;, :status=&gt;403, :allow_empty_referrer=&gt;true, :report_key=&gt;&quot;protection.failed&quot;, :html_types=&gt;[&quot;text/html&quot;, &quot;application/xhtml&quot;, &quot;text/xml&quot;, &quot;application/xml&quot;], :allow_if=&gt;nil, :img_src=&gt;&quot;&#39;self&#39; data:&quot;, :font_src=&gt;&quot;&#39;self&#39;&quot;, :without_session=&gt;false}&gt;, @options={:reaction=&gt;:drop_session, :logging=&gt;true, :message=&gt;&quot;Forbidden&quot;, :encryptor=&gt;Digest::SHA1, :session_key=&gt;&quot;rack.session&quot;, :status=&gt;403, :allow_empty_referrer=&gt;true, :report_key=&gt;&quot;protection.failed&quot;, :html_types=&gt;[&quot;text/html&quot;, &quot;application/xhtml&quot;, &quot;text/xml&quot;, &quot;application/xml&quot;], :img_src=&gt;&quot;&#39;self&#39; data:&quot;, :font_src=&gt;&quot;&#39;self&#39;&quot;, :without_session=&gt;false}&gt;, @options={:reaction=&gt;:drop_session, :logging=&gt;true, :message=&gt;&quot;Forbidden&quot;, :encryptor=&gt;Digest::SHA1, :session_key=&gt;&quot;rack.session&quot;, :status=&gt;403, :allow_empty_referrer=&gt;true, :report_key=&gt;&quot;protection.failed&quot;, :html_types=&gt;[&quot;text/html&quot;, &quot;application/xhtml&quot;, &quot;text/xml&quot;, &quot;application/xml&quot;], :allow_if=&gt;nil, :img_src=&gt;&quot;&#39;self&#39; data:&quot;, :font_src=&gt;&quot;&#39;self&#39;&quot;, :without_session=&gt;false}&gt;, @options={:reaction=&gt;:drop_session, :logging=&gt;true, :message=&gt;&quot;Forbidden&quot;, :encryptor=&gt;Digest::SHA1, :session_key=&gt;&quot;rack.session&quot;, :status=&gt;403, :allow_empty_referrer=&gt;true, :report_key=&gt;&quot;protection.failed&quot;, :html_types=&gt;[&quot;text/html&quot;, &quot;application/xhtml&quot;, &quot;text/xml&quot;, &quot;application/xml&quot;], :frame_options=&gt;:sameorigin, :img_src=&gt;&quot;&#39;self&#39; data:&quot;, :font_src=&gt;&quot;&#39;self&#39;&quot;, :without_session=&gt;false}, @frame_options=&quot;SAMEORIGIN&quot;&gt;, @default_options={:path=&gt;&quot;/&quot;, :domain=&gt;nil, :expire_after=&gt;nil, :secure=&gt;false, :httponly=&gt;true, :defer=&gt;false, :renew=&gt;false, :sidbits=&gt;128, :secure_random=&gt;SecureRandom, :secret=&gt;&quot;f54d0a65ee092cad072bee4020db9684015b3686226470dac758b6cc57cc5dd6a17172d9fed0ea63f5e3ad7632ed9327213aea56426429f2fd9bd802a04e43b4&quot;, :coder=&gt;#&lt;Rack::Session::Cookie::Base64::Marshal:0x00007fd72aa337d0&gt;}, @key=&quot;rack.session&quot;, @cookie_only=true, @same_site=nil, @sidbits=128, @sid_secure=SecureRandom, @sid_length=32&gt;&gt;</div></td>
         </tr>
         
         <tr>
           <td>rack.multiprocess</td>
           <td class="code"><div>false</div></td>
         </tr>
         
         <tr>
           <td>rack.multithread</td>
           <td class="code"><div>true</div></td>
         </tr>
         
         <tr>
           <td>rack.request.cookie_hash</td>
           <td class="code"><div>{}</div></td>
         </tr>
         
         <tr>
           <td>rack.request.form_hash</td>
           <td class="code"><div>{}</div></td>
         </tr>
         
         <tr>
           <td>rack.request.form_input</td>
           <td class="code"><div>#&lt;Rack::Lint::Wrapper::InputWrapper:0x00007fd727a7a868 @input=#&lt;Puma::NullIO:0x00007fd729680878&gt;&gt;</div></td>
         </tr>
         
         <tr>
           <td>rack.request.query_hash</td>
           <td class="code"><div>{&quot;static&quot;=&gt;&quot;1&quot;, &quot;iPad&quot;=&gt;&quot;1&quot;}</div></td>
         </tr>
         
         <tr>
           <td>rack.request.query_string</td>
           <td class="code"><div>static=1&amp;iPad=1</div></td>
         </tr>
         
         <tr>
           <td>rack.run_once</td>
           <td class="code"><div>false</div></td>
         </tr>
         
         <tr>
           <td>rack.session</td>
           <td class="code"><div>{&quot;session_id&quot;=&gt;&quot;c3db07fe876d7ae21b0434eafe8b8d9d148d6ba4dc6e5f3360d78b999e7e16c5&quot;, &quot;csrf&quot;=&gt;&quot;nooptVE7Xm3lwY2fzF9ShDEjb0smwtAqg-i_4eVF5lM=&quot;}</div></td>
         </tr>
         
         <tr>
           <td>rack.session.options</td>
           <td class="code"><div>{:path=&gt;&quot;/&quot;, :domain=&gt;nil, :expire_after=&gt;nil, :secure=&gt;false, :httponly=&gt;true, :defer=&gt;false, :renew=&gt;false, :sidbits=&gt;128, :secure_random=&gt;SecureRandom, :secret=&gt;&quot;f54d0a65ee092cad072bee4020db9684015b3686226470dac758b6cc57cc5dd6a17172d9fed0ea63f5e3ad7632ed9327213aea56426429f2fd9bd802a04e43b4&quot;, :coder=&gt;#&lt;Rack::Session::Cookie::Base64::Marshal:0x00007fd72aa337d0&gt;}</div></td>
         </tr>
         
         <tr>
           <td>rack.session.unpacked_cookie_data</td>
           <td class="code"><div>{&quot;session_id&quot;=&gt;&quot;c3db07fe876d7ae21b0434eafe8b8d9d148d6ba4dc6e5f3360d78b999e7e16c5&quot;}</div></td>
         </tr>
         
         <tr>
           <td>rack.tempfiles</td>
           <td class="code"><div>[]</div></td>
         </tr>
         
         <tr>
           <td>rack.url_scheme</td>
           <td class="code"><div>http</div></td>
         </tr>
         
         <tr>
           <td>rack.version</td>
           <td class="code"><div>[1, 6]</div></td>
         </tr>
         
         <tr>
           <td>sinatra.accept</td>
           <td class="code"><div>[#&lt;Sinatra::Request::AcceptEntry:0x00007fd7272d5838 @entry=&quot;*/*&quot;, @type=&quot;*/*&quot;, @params={}, @q=1.0&gt;]</div></td>
         </tr>
         
         <tr>
           <td>sinatra.error</td>
           <td class="code"><div>#&lt;NoMethodError: undefined method `empty?&#39; for nil:NilClass&gt;</div></td>
         </tr>
         
         <tr>
           <td>sinatra.error.params</td>
           <td class="code"><div>{&quot;static&quot;=&gt;&quot;1&quot;, &quot;iPad&quot;=&gt;&quot;1&quot;, &quot;program&quot;=&gt;&quot;2024-03-TH&quot;}</div></td>
         </tr>
         
         <tr>
           <td>sinatra.route</td>
           <td class="code"><div>GET /list/:program</div></td>
         </tr>
         
      </table>
      <div class="clear"></div>
    </div> <!-- /RACK ENV -->

    <p id="explanation">You're seeing this error because you have
enabled the <code>show_exceptions</code> setting.</p>
  </div> <!-- /WRAP -->
  </body>
</html>
